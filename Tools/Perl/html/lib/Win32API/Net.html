<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../displayToc.js"></script>
<script language="JavaScript" src="../../tocParas.js"></script>
<script language="JavaScript" src="../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../scineplex.css">
<title></title>
<link rel="stylesheet" href="../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#NOTE-ON-VERSIONS-PRIOR-TO-0.08">NOTE ON VERSIONS PRIOR TO 0.08</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a>
    <ul>
      <li><a href="#Using-References">Using References</a></li>
    </ul>
  </li>
  <li><a href="#DATA-STRUCTURES">DATA STRUCTURES</a></li>
  <li><a href="#EXPORTS">EXPORTS</a></li>
  <li><a href="#NET-USER-FUNCTIONS1">NET USER FUNCTIONS</a>
    <ul>
      <li><a href="#UserAdd-server-level-hash-error">UserAdd(server, level, hash, error)</a></li>
      <li><a href="#UserChangePassword-server-user-old-new">UserChangePassword(server, user, old, new)</a></li>
      <li><a href="#UserDel-server-user">UserDel(server, user)</a></li>
      <li><a href="#UserEnum-server-array-filter">UserEnum(server, array[, filter])</a></li>
      <li><a href="#UserGetGroups-server-user-array">UserGetGroups(server, user, array)</a></li>
      <li><a href="#UserGetInfo-server-user-level-hash">UserGetInfo(server, user, level, hash)</a></li>
      <li><a href="#UserGetLocalGroups-server-user-array-flags">UserGetLocalGroups(server, user, array[, flags])</a></li>
      <li><a href="#UserModalsGet">UserModalsGet()</a></li>
      <li><a href="#UserModalsSet">UserModalsSet()</a></li>
      <li><a href="#UserSetGroups-server-user-array">UserSetGroups(server, user, array)</a></li>
      <li><a href="#UserSetInfo-server-user-level-hash-error">UserSetInfo(server, user, level, hash, error)</a></li>
    </ul>
  </li>
  <li><a href="#NET-GROUP-FUNCTIONS1">NET GROUP FUNCTIONS</a>
    <ul>
      <li><a href="#GroupAdd-server-level-hash-error">GroupAdd(server, level, hash, error)</a></li>
      <li><a href="#GroupAddUser-server-group-user">GroupAddUser(server, group, user)</a></li>
      <li><a href="#GroupDel-server-group">GroupDel(server, group)</a></li>
      <li><a href="#GroupDelUser-server-group-user">GroupDelUser(server, group, user)</a></li>
      <li><a href="#GroupEnum-server-array">GroupEnum(server, array)</a></li>
      <li><a href="#GroupGetInfo-server-group-level-hash">GroupGetInfo(server, group, level, hash)</a></li>
      <li><a href="#GroupGetUsers-server-group-array">GroupGetUsers(server, group, array)</a></li>
      <li><a href="#GroupSetInfo-server-group-level-hash-error">GroupSetInfo(server, group, level, hash, error)</a></li>
      <li><a href="#GroupSetUsers-server-group-array">GroupSetUsers(server, group, array)</a></li>
    </ul>
  </li>
  <li><a href="#NET-LOCAL-GROUP-FUNCTIONS1">NET LOCAL GROUP FUNCTIONS</a>
    <ul>
      <li><a href="#LocalGroupAdd-server-level-hash-error">LocalGroupAdd(server, level, hash, error)</a></li>
      <li><a href="#LocalGroupAddMember">LocalGroupAddMember()</a></li>
      <li><a href="#LocalGroupAddMembers-server-group-array">LocalGroupAddMembers(server, group, array)</a></li>
      <li><a href="#LocalGroupDel-server-group">LocalGroupDel(server, group)</a></li>
      <li><a href="#LocalGroupDelMember">LocalGroupDelMember()</a></li>
      <li><a href="#LocalGroupDelMembers-server-group-array">LocalGroupDelMembers(server, group, array)</a></li>
      <li><a href="#LocalGroupEnum-server-array">LocalGroupEnum(server, array)</a></li>
      <li><a href="#LocalGroupGetInfo-server-group-level-hash">LocalGroupGetInfo(server, group, level, hash)</a></li>
      <li><a href="#LocalGroupGetMembers-server-group-hash">LocalGroupGetMembers(server, group, hash)</a></li>
      <li><a href="#LocalGroupSetInfo-server-level-hash-error">LocalGroupSetInfo(server, level, hash, error)</a></li>
      <li><a href="#LocalGroupSetMembers">LocalGroupSetMembers()</a></li>
    </ul>
  </li>
  <li><a href="#NET-GET-FUNCTIONS1">NET GET FUNCTIONS</a>
    <ul>
      <li><a href="#GetDCName-server-domain-domain-controller">GetDCName(server, domain, domain-controller)</a></li>
    </ul>
  </li>
  <li><a href="#USER-INFO-LEVELS">USER INFO LEVELS</a></li>
  <li><a href="#USER-INFO-FIELDS">USER INFO FIELDS</a></li>
  <li><a href="#USER-FLAGS">USER FLAGS</a></li>
  <li><a href="#USER-PRIVILEGE-FLAGS">USER PRIVILEGE FLAGS</a></li>
  <li><a href="#USER-ENUM-FILTER">USER ENUM FILTER</a></li>
  <li><a href="#USER-FIELD-ERRORS">USER FIELD ERRORS</a></li>
  <li><a href="#GROUP-INFO-LEVELS">GROUP INFO LEVELS</a></li>
  <li><a href="#GROUP-INFO-FIELDS">GROUP INFO FIELDS</a></li>
  <li><a href="#GROUP-FIELD-ERRORS">GROUP FIELD ERRORS</a></li>
  <li><a href="#GROUP-USERS-INFO-LEVELS">GROUP USERS INFO LEVELS</a></li>
  <li><a href="#GROUP-USERS-INFO-FIELDS">GROUP USERS INFO FIELDS</a></li>
  <li><a href="#LOCAL-GROUP-INFO-LEVELS">LOCAL GROUP INFO LEVELS</a></li>
  <li><a href="#LOCAL-GROUP-INFO-FIELDS">LOCAL GROUP INFO FIELDS</a></li>
  <li><a href="#LOCAL-GROUP-FIELD-ERRORS">LOCAL GROUP FIELD ERRORS</a></li>
  <li><a href="#EXAMPLES">EXAMPLES</a></li>
  <li><a href="#AUTHOR">AUTHOR</a></li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
  <li><a href="#ACKNOWEDGEMENTS">ACKNOWEDGEMENTS</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Win32API::Net - Perl interface to the Windows NT LanManager API account management functions.</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<p>use Win32API::Net;</p>

<h1 id="NOTE-ON-VERSIONS-PRIOR-TO-0.08">NOTE ON VERSIONS PRIOR TO 0.08</h1>

<p>As of version 0.08 of this module, the behaviour relating to empty strings in input hashes has changed. The old behaviour converted such strings to the NULL pointer. The underlying API uses this value as an indication to not change the value stored for a given field. This meant that you were not able to clear (say) the logonScript field for a user using UserSetInfo().</p>

<p>The new behaviour is to leave the string as an empty C string which will allow fields to be cleared. To pass a NULL pointer to the underlying API call (and thus, to leave the field as it was), you need to set the corresponding field to <code>undef</code>.</p>

<p>WARNING: <b>THIS IS AN INCOMPATIBLE CHANGE</b>. <b>EXISTING SCRIPTS THAT RELIED ON PRIOR BEHAVIOR MAY NEED TO BE MODIFIED</b>.</p>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>Win32API::Net provides a more complete wrapper for the account management parts of the NT LanManager API than do other similar packages. Most of what you can achieve with the native C++ API is possible with this package - albeit in a more Perl like manner by using references to pass information to and from functions.</p>

<p>For an understanding of the environment in which these functions operate see <a href="#DATA-STRUCTURES">&quot;DATA STRUCTURES&quot;</a>.</p>

<p>The following groups of functions are available:</p>

<dl>

<dt id="NET-USER-FUNCTIONS"><a href="#NET-USER-FUNCTIONS">&quot;NET USER FUNCTIONS&quot;</a></dt>
<dd>

</dd>
<dt id="NET-GROUP-FUNCTIONS"><a href="#NET-GROUP-FUNCTIONS">&quot;NET GROUP FUNCTIONS&quot;</a></dt>
<dd>

</dd>
<dt id="NET-LOCAL-GROUP-FUNCTIONS"><a href="#NET-LOCAL-GROUP-FUNCTIONS">&quot;NET LOCAL GROUP FUNCTIONS&quot;</a></dt>
<dd>

</dd>
<dt id="NET-GET-FUNCTIONS"><a href="#NET-GET-FUNCTIONS">&quot;NET GET FUNCTIONS&quot;</a></dt>
<dd>

</dd>
</dl>

<p>All functions return 0 on failure and 1 on success. Use the <code>Win32::GetLastError()</code> function to find out more information on why a function failed. In addition, some functions that take a hash reference to pass information in (e.g. <code>UserAdd()</code>) have a last argument that will allow more detailed information on which key/value pair was not properly specified.</p>

<h2 id="Using-References">Using References</h2>

<p>References to hashes and arrays are used throughout this package to pass information into and out of functions.</p>

<dl>

<dt id="Using-Hash-References">Using Hash References</dt>
<dd>

<p>Where a hash reference is required you can use anything that evaluates to a hash reference. e.g.</p>

<pre><code>        <span class="variable">$href</span> <span class="operator">=</span> <span class="operator">\</span><span class="variable">%someHash</span><span class="operator">;</span>
        <span class="variable">UserAdd</span><span class="operator">(</span><span class="variable">server</span><span class="operator">,</span> <span class="number">2</span><span class="operator">,</span> <span class="variable">$hRef</span><span class="operator">);</span>
</code></pre>

<p>Or more directly:</p>

<pre><code>        <span class="variable">UserAdd</span><span class="operator">(</span><span class="variable">server</span><span class="operator">,</span> <span class="number">2</span><span class="operator">,</span> <span class="operator">\</span><span class="variable">%someHash</span><span class="operator">);</span>
</code></pre>

</dd>
<dt id="Using-Array-references">Using Array references</dt>
<dd>

<p>Array references are used in a similar manner to hash references. e.g.</p>

<pre><code>        <span class="variable">$aref</span> <span class="operator">=</span> <span class="operator">\</span><span class="variable">@someArray</span><span class="operator">;</span>
        <span class="variable">UserEnum</span><span class="operator">(</span><span class="variable">server</span><span class="operator">,</span> <span class="variable">$aref</span><span class="operator">);</span>
</code></pre>

<p>Or more directly:</p>

<pre><code>        <span class="variable">UserEnum</span><span class="operator">(</span><span class="variable">server</span><span class="operator">,</span> <span class="operator">\</span><span class="variable">@someArray</span><span class="operator">);</span>
</code></pre>

</dd>
</dl>

<p>Please note: Any <code>*Get*()</code> or <code>*Enum()</code> operation will first clear the contents of the input hash or array being referenced.</p>

<p>See <a>EXAMPLES</a> and the test.pl script for examples of usage.</p>

<h1 id="DATA-STRUCTURES">DATA STRUCTURES</h1>

<p>Most of the functions in the underlying API allow the programmer to pass specify at runtime the amount of information that is supplied to the function. For example, the <code>NetUserGetInfo()</code> call allows the programmer to specify levels of 0, 1, 2, 3 (and others). Having specified this level, the function returns a structure that will contain different fields. For a level <code>0</code>, the function returns a structure that has only one field. For a supplied level of 1, the function returns a structure with <code>8</code> fields. The programmer needs to know in advance what fields should be provided or will be returned for a given level. This mechanism works very will since it effectively overloads functions without having to use different function prototypes. Perl provides better higher level data structures in the form of arrays and hashes. This package uses hashes as the means to pass these variable size structure into and out of functions.</p>

<p>For any function that takes a reference to a hash as input, the programmer is expected to provide appropriate keys and corresponding values as well as the level parameter. The called function will then takes the values out of the supplied hash and build the appropriate structure to pass to the underlying API function.</p>

<p>For any function that takes a reference to a hash to receive output, the function will first clear any keys an corresponding values in the supplied hash. It will call the underlying API call and will then return in the hash any keys and values that are applicable at the requested level.</p>

<p>Example:</p>

<p>The <code>UserGetInfo()</code> can takes a number of levels. If called with level <code>0</code> the supplied hash will, on return from the function, contain a single key and value - namely <b>name</b>/<b>requested-users-name</b>. If called with a level of <code>1</code> the supplied hash will, on return from the function, contain 8 keys and values. The returned keys are <code>name, password</code>, <code>passwordAge</code>, <code>priv</code>, <code>homeDir</code>, <code>comment</code>, <code>flags</code>, <code>scriptPath</code>. See <a href="#USER-INFO-FIELDS">&quot;USER INFO FIELDS&quot;</a> for more information on what these represent.</p>

<h1 id="EXPORTS">EXPORTS</h1>

<p>By default, Win32API::Net exports no symbols into the callers namespace. The following tags can be used to selectively import symbols into the main namespace.</p>

<dl>

<dt id="User"><code>:User</code></dt>
<dd>

<p>Exports all symbols needed for the <code>User*()</code> functions. See <a href="#NET-USER-FUNCTIONS">&quot;NET USER FUNCTIONS&quot;</a>.</p>

</dd>
<dt id="Get"><code>:Get</code></dt>
<dd>

<p>Exports all symbols needed for the <code>Get*()</code> functions. See <a href="#NET-GET-FUNCTIONS">&quot;NET GET FUNCTIONS&quot;</a>.</p>

</dd>
<dt id="Group"><code>:Group</code></dt>
<dd>

<p>Exports all symbols needed for the <code>Group*()</code> functions. See <a href="#NET-GROUP-FUNCTIONS">&quot;NET GROUP FUNCTIONS&quot;</a>.</p>

</dd>
<dt id="LocalGroup"><code>:LocalGroup</code></dt>
<dd>

<p>Exports all symbols needed for the <code>LocalGroup*()</code> functions. See <a href="#NET-LOCAL-GROUP-FUNCTIONS">&quot;NET LOCAL GROUP FUNCTIONS&quot;</a>.</p>

</dd>
</dl>

<h1 id="NET-USER-FUNCTIONS1">NET USER FUNCTIONS</h1>

<p>The <code>User*()</code> functions operate on NT user accounts.</p>

<p>Administrator or Account Operator group membership is required to successfully execute most of these functions on a remote server or on a computer that has local security enabled. Administrator privileges are required to add an Administrator Privilege account. There are some exceptions to this whereby a user can change some of their own settings where these don&#39;t conflict with &#39;administrative information&#39; (e.g. full name).</p>

<p>The <code>server</code> field can be the empty string, in which case the function defaults to running on the local computer. If you leave this field blank then you should ensure that you are running the function on a PDC or BDC for your current domain. Use the support function <code>GetDCName()</code> to find out what the domain controller is, should you not be running this on the PDC.</p>

<p>All functions in this section are &#39;DOMAIN functions&#39;. This means that, for example, the <code>UserGetLocalGroups()</code> function actually lists the domain&#39;s local groups of which the named user is a member.</p>

<p>The following functions are available.</p>

<h2 id="UserAdd-server-level-hash-error">UserAdd(server, level, hash, error)</h2>

<p>Add a new user account. The user name is taken from the <code>name</code>-key&#39;s value in the supplied hash.</p>

<dl>

<dt id="server---Scalar-String"><code>server</code> - Scalar String</dt>
<dd>

<p>The server on which to add the account.</p>

</dd>
<dt id="level---Scalar-Int"><code>level</code> - Scalar Int</dt>
<dd>

<p>Level of information provided in hash. This can be either 1, 2 or 3. See <a href="#USER-INFO-LEVELS">&quot;USER INFO LEVELS&quot;</a>.</p>

</dd>
<dt id="hash---Hash-Reference"><code>hash</code> - Hash Reference</dt>
<dd>

<p>The information to use to add this account. This should have all the appropriate keys and values required for <code>level</code>.</p>

</dd>
<dt id="error---Scalar-Int"><code>error</code> - Scalar Int</dt>
<dd>

<p>Provides information on which field in the hash was not properly specified. See <a href="#USER-FIELD-ERRORS">&quot;USER FIELD ERRORS&quot;</a> for more information about what values this can take.</p>

</dd>
</dl>

<h2 id="UserChangePassword-server-user-old-new">UserChangePassword(server, user, old, new)</h2>

<p>Changes the password for <code>user</code>. If the policy of the machine/domain only allows password changes if the <code>user</code> is logged on then the <code>user</code> must be logged on to execute this function. With Administrator or Account Operator privilege you can use this function to change anyone&#39;s password, so long as you know the old password.</p>

<dl>

<dt id="server---Scalar-String1"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> on which to change the password.</p>

</dd>
<dt id="user---Scalar-String"><code>user</code> - Scalar String</dt>
<dd>

<p>The name of the <code>user</code> whose password is being changed.</p>

</dd>
<dt id="old---Scalar-String"><code>old</code> - Scalar String</dt>
<dd>

<p>The existing password for <code>user</code>.</p>

</dd>
<dt id="new---Scalar-String"><code>new</code> - Scalar String</dt>
<dd>

<p>The new password for <code>user</code>.</p>

</dd>
</dl>

<h2 id="UserDel-server-user">UserDel(server, user)</h2>

<p>Deletes the specified <code>user</code> account. Administrator or Account Operator privilege is required to execute this function.</p>

<dl>

<dt id="server---Scalar-String2"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> on which to delete the <code>user</code>.</p>

</dd>
<dt id="user---Scalar-String1"><code>user</code> - Scalar String</dt>
<dd>

<p>The <code>user</code> account to delete.</p>

</dd>
</dl>

<h2 id="UserEnum-server-array-filter">UserEnum(server, array[, filter])</h2>

<p>Enumerates all the accounts on server that satisfy <code>filter</code>. Unlike the <code>NetUserEnum()</code> function in the API, this function does not allow you to specify a level (internally it is hardcoded to 0). In Perl it is trivial to implement the equivalent function (should you need it) - see <a href="#Example-1">&quot;Example 1&quot;</a>.</p>

<dl>

<dt id="server---Scalar-String3"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> on which to enumerate the accounts satisfying <code>filter</code>.</p>

</dd>
<dt id="array---Array-Reference"><code>array</code> - Array Reference</dt>
<dd>

<p>The array that will hold the names of all users on <code>server</code> whose accounts match <code>filter</code>.</p>

</dd>
<dt id="filter---Scalar-Int-optional"><code>filter</code> - Scalar Int (optional)</dt>
<dd>

<p>The filter to apply (see <a href="#USER-ENUM-FILTER">&quot;USER ENUM FILTER&quot;</a>). This argument is optional and if not present a default of <code>FILTER_NORMAL_ACCOUNT</code> is used.</p>

</dd>
</dl>

<h2 id="UserGetGroups-server-user-array">UserGetGroups(server, user, array)</h2>

<p>Get the global groups for which <code>user</code> is a member. It returns the group names in <code>array</code>. Unlike the <code>NetUserGetGroups()</code> function in the API, this function does not allow you to specify a level (internally is hardcoded to 0). In Perl it is trivial to implement the equivalent function (in the unlikely event that you might need it).</p>

<dl>

<dt id="server---Scalar-String4"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> from which to get the groups of which <code>user</code> is a member.</p>

</dd>
<dt id="user---Scalar-String2"><code>user</code> - Scalar String</dt>
<dd>

<p>The <code>user</code> whose group membership you wish to examine.</p>

</dd>
<dt id="array---Scalar-String"><code>array</code> - Scalar String</dt>
<dd>

<p>The array that will contain the group names to which <code>user</code> belongs.</p>

</dd>
</dl>

<h2 id="UserGetInfo-server-user-level-hash">UserGetInfo(server, user, level, hash)</h2>

<p>Returns the information at the specified <code>level</code> for the named <code>user</code> in <code>hash</code>.</p>

<dl>

<dt id="server---Scalar-String5"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> from which to get the requested information about <code>user</code>.</p>

</dd>
<dt id="user---Scalar-String3"><code>user</code> - Scalar String</dt>
<dd>

<p>The <code>user</code> whose information you want.</p>

</dd>
<dt id="level---Scalar-Int1"><code>level</code> - Scalar Int</dt>
<dd>

<p>One of: 0, 1, 2, 3, 4, 10, 11, 20, 21, 22 and 23. See <a href="#USER-INFO-LEVELS">&quot;USER INFO LEVELS&quot;</a>.</p>

</dd>
<dt id="hash---Hash-Reference1"><code>hash</code> - Hash Reference</dt>
<dd>

<p>The hash that will contain the keys and values for the information requested. See <a href="#USER-INFO-FIELDS">&quot;USER INFO FIELDS&quot;</a> for information about which keys are present in a given level.</p>

</dd>
</dl>

<h2 id="UserGetLocalGroups-server-user-array-flags">UserGetLocalGroups(server, user, array[, flags])</h2>

<p>Gets the names of the local groups of which <code>user</code> is a member. Unlike the <code>NetUserEnum()</code> function in the API, this function does not allow you to specify a level. Since the underlying API restricts you to level 0 there really isn&#39;t any need to include it...</p>

<dl>

<dt id="server---Scalar-String6"><code>server</code> - Scalar String</dt>
<dd>

<p>The server from which to get the local groups of which <code>user</code> is a member.</p>

</dd>
<dt id="user---Scalar-String4"><code>user</code> - Scalar String</dt>
<dd>

<p>The <code>user</code> whose local group membership you wish to enumerate.</p>

</dd>
<dt id="array---Array-Reference1"><code>array</code> - Array Reference</dt>
<dd>

<p>The array that will hold the names of the local groups to which <code>user</code> belongs.</p>

</dd>
<dt id="flags---Scalar-Int-em-optional-em"><code>flags</code> - Scalar Int &lt;em&gt;(optional)&lt;/em&gt;</dt>
<dd>

<p>Either <code>Win32API::Net::LG_INCLUDE_INDIRECT()</code> or 0. if <code>flags</code> is omitted, the function internally uses 0. Specifying <code>LG_INCLUDE_INDIRECT()</code> will include in the list the names of the groups of which the <code>user</code> is indirectly a member (e.g. by being in a global group that is a member of a local group).</p>

<p>This field can take no other values.</p>

</dd>
</dl>

<h2 id="UserModalsGet">UserModalsGet()</h2>

<p>This function is not currently implemented.</p>

<h2 id="UserModalsSet">UserModalsSet()</h2>

<p>This function is not currently implemented.</p>

<h2 id="UserSetGroups-server-user-array">UserSetGroups(server, user, array)</h2>

<p>Sets the (global) group membership for <code>user</code> to the specified groups. Unlike the API function <code>NetUserSetGroups()</code>, this function does not take a <code>level</code> parameter (mainly because this option is largely redundant).</p>

<dl>

<dt id="server---Scalar-String7"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> on which you wish to set the group membership for <code>user</code>.</p>

</dd>
<dt id="user---Scalar-String5"><code>user</code> - Scalar String</dt>
<dd>

<p>The <code>user</code> whose group membership you wish to set.</p>

</dd>
<dt id="array---Array-Reference2"><code>array</code> - Array Reference</dt>
<dd>

<p>The array containing the (global) group names to set the <code>user</code>s membership of.</p>

</dd>
</dl>

<p>This function will fail if any of the group names specified do not exist.</p>

<h2 id="UserSetInfo-server-user-level-hash-error">UserSetInfo(server, user, level, hash, error)</h2>

<p>Sets the info for <code>user</code> according to the information contained in <code>hash</code> for <code>level</code> (see <a href="#USER-INFO-LEVELS">&quot;USER INFO LEVELS&quot;</a>).</p>

<dl>

<dt id="server---Scalar-String8"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> on which you wish to change the info for <code>user</code>.</p>

</dd>
<dt id="user---Scalar-String6"><code>user</code> - Scalar String</dt>
<dd>

<p>The <code>user</code> whose info you wish to change.</p>

</dd>
<dt id="level---Scalar-Int2"><code>level</code> - Scalar Int</dt>
<dd>

<p>One of 0, 1, 2, 3, or 20 (according to Microsoft documentation). In practice, you can use all the 10xx levels as well to change most of the individual properties of the named <code>user</code> - although this may not be supported in future...</p>

</dd>
<dt id="hash---Hash-Reference2"><code>hash</code> - Hash Reference</dt>
<dd>

<p>The hash that will contain the necessary key/value pairs required for <code>level</code> (see <a href="#USER-INFO-LEVELS">&quot;USER INFO LEVELS&quot;</a>).</p>

</dd>
<dt id="error---Scalar-Int1"><code>error</code> - Scalar Int</dt>
<dd>

<p>Provides information on which field in <code>hash</code> were not properly specified. See <a href="#USER-FIELD-ERRORS">&quot;USER FIELD ERRORS&quot;</a> for more information about what values can be returned in this field.</p>

</dd>
</dl>

<h1 id="NET-GROUP-FUNCTIONS1">NET GROUP FUNCTIONS</h1>

<p>The <code>Group*()</code> functions all operate only on global groups. To modify local groups, use the corresponding <code>LocalGroup*()</code> functions.</p>

<p>Administrator or Account Operator group membership is required to successfully execute most of these functions on a remote server or on a computer that has local security enabled.</p>

<p>The <code>server</code> field can be the empty string, in which case the function defaults to running on the local computer. If you leave this field blank then you should ensure that you are running the function on a PDC or BDC for your current domain. Use the support function <code>GetDCName()</code> to find out what the domain controller is, should you not be running this on the PDC.</p>

<p>The following functions are available.</p>

<h2 id="GroupAdd-server-level-hash-error">GroupAdd(server, level, hash, error)</h2>

<p>Adds the specified group.</p>

<dl>

<dt id="server---Scalar-String9"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> on which to add the group.</p>

</dd>
<dt id="level---Scalar-String"><code>level</code> - Scalar String</dt>
<dd>

<p>The <code>level</code> of information contained in <code>hash</code>. This can be one of 0, 1, 2 or 3. See <a href="#GROUP-INFO-LEVELS">&quot;GROUP INFO LEVELS&quot;</a>.</p>

</dd>
<dt id="hash---Hash-Reference3"><code>hash</code> - Hash Reference</dt>
<dd>

<p>A hash containing the required key/value pairs for <code>level</code>.</p>

</dd>
<dt id="error---Scalar-Int2"><code>error</code> - Scalar Int</dt>
<dd>

<p>Provides information on which field in <code>hash</code> was not properly specified. See <a href="#GROUP-FIELD-ERRORS">&quot;GROUP FIELD ERRORS&quot;</a> for more information about what values can be returned in this field.</p>

</dd>
</dl>

<h2 id="GroupAddUser-server-group-user">GroupAddUser(server, group, user)</h2>

<p>Adds the specified <code>user</code> to the specified <code>group</code>.</p>

<dl>

<dt id="server---Scalar-String10"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> on which to add the <code>user</code> to <code>group</code>.</p>

</dd>
<dt id="group---Scalar-String"><code>group</code> - Scalar String</dt>
<dd>

<p>The <code>group</code> to add the <code>user</code> to.</p>

</dd>
<dt id="user---Scalar-String7"><code>user</code> - Scalar String</dt>
<dd>

<p>The <code>user</code> to add to <code>group</code>.</p>

</dd>
</dl>

<h2 id="GroupDel-server-group">GroupDel(server, group)</h2>

<p>Deletes the specified global group.</p>

<dl>

<dt id="server---Scalar-String11"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> on which to delete the named <code>group</code>.</p>

</dd>
<dt id="group--Scalar-String"><code>group</code> -Scalar String</dt>
<dd>

<p>The <code>group</code> to delete.</p>

</dd>
</dl>

<h2 id="GroupDelUser-server-group-user">GroupDelUser(server, group, user)</h2>

<p>Deletes the specified user from the specified group.</p>

<dl>

<dt id="server---Scalar-String12"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> on which to delete <code>user</code> from <code>group</code>.</p>

</dd>
<dt id="group---Scalar-String1"><code>group</code> - Scalar String</dt>
<dd>

<p>The <code>group</code> from which to delete <code>user</code>.</p>

</dd>
<dt id="user---Scalar-String8"><code>user</code> - Scalar String</dt>
<dd>

<p>The <code>user</code> to delete from <code>group</code>.</p>

</dd>
</dl>

<h2 id="GroupEnum-server-array">GroupEnum(server, array)</h2>

<p>Enumerates all the global groups on the server. Unlike the API call <code>NetGroupEnum()</code>, this function does not allow you to specify a level (internally it is hardcoded to 0). In Perl it is trivial to implement the equivalent function (should you need it).</p>

<dl>

<dt id="server---Scalar-String13"><code>server</code> - Scalar String</dt>
<dd>

<p>The server on which to enumerate the (global) <code>groups</code>.</p>

</dd>
<dt id="array---Array-Reference3"><code>array</code> - Array Reference</dt>
<dd>

<p>An array that, on return, will contain the <code>group</code> names.</p>

</dd>
</dl>

<h2 id="GroupGetInfo-server-group-level-hash">GroupGetInfo(server, group, level, hash)</h2>

<p>Retrieves <code>level</code> information for <code>group</code> returning information in <code>hash</code>.</p>

<dl>

<dt id="server---Scalar-String14"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> from which to get the group information.</p>

</dd>
<dt id="group---Scalar-String2"><code>group</code> - Scalar String</dt>
<dd>

<p>The <code>group</code> whose information you wish to obtain.</p>

</dd>
<dt id="level---Scalar-Int3"><code>level</code> - Scalar Int</dt>
<dd>

<p>The <code>level</code> of information you wish to retrieve. This can be one of 1, 2 or 3. See <a href="#GROUP-INFO-LEVELS">&quot;GROUP INFO LEVELS&quot;</a>.</p>

</dd>
<dt id="hash---Hash-Reference4"><code>hash</code> - Hash Reference</dt>
<dd>

<p>The hash that will contain the information.</p>

</dd>
</dl>

<h2 id="GroupGetUsers-server-group-array">GroupGetUsers(server, group, array)</h2>

<p>Returns (in <code>array</code>) the users belonging to <code>group</code>. Unlike the API call <code>NetGroupGetUsers()</code>, this function does not allow you to specify a level (internally it is hardcoded to 0). In Perl it is trivial to implement the equivalent function (should you need it).</p>

<dl>

<dt id="server---Scalar-String15"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> from which to get the group information.</p>

</dd>
<dt id="group---Scalar-String3"><code>group</code> - Scalar String</dt>
<dd>

<p>The <code>group</code> whose users you wish to obtain.</p>

</dd>
<dt id="array---Array-Reference4"><code>array</code> - Array Reference</dt>
<dd>

<p>The array to hold the user names retrieved.</p>

</dd>
</dl>

<h2 id="GroupSetInfo-server-group-level-hash-error">GroupSetInfo(server, group, level, hash, error)</h2>

<p>Sets the information for <code>group</code> according to <code>level</code>.</p>

<dl>

<dt id="server---Scalar-String16"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> on which to set the <code>group</code> information.</p>

</dd>
<dt id="group---Scalar-String4"><code>group</code> - Scalar String</dt>
<dd>

<p>The <code>group</code> whose information you wish to set.</p>

</dd>
<dt id="level---Scalar-Int4"><code>level</code> - Scalar Int</dt>
<dd>

<p>The <code>level</code> of information you are supplying in <code>hash</code>. Level can be one of 0, 1 or 2. See <a href="#GROUP-INFO-LEVELS">&quot;GROUP INFO LEVELS&quot;</a>.</p>

</dd>
<dt id="hash---Hash-Reference5"><code>hash</code> - Hash Reference</dt>
<dd>

<p>The hash containing the required key/value pairs for <code>level</code>.</p>

</dd>
<dt id="error---Scalar-String"><code>error</code> - Scalar String</dt>
<dd>

<p>On failure, the <code>error</code> parameter will contain a value which specifies which field caused the error. See <a href="#GROUP-FIELD-ERRORS">&quot;GROUP FIELD ERRORS&quot;</a>.</p>

</dd>
</dl>

<h2 id="GroupSetUsers-server-group-array">GroupSetUsers(server, group, array)</h2>

<p>Sets the membership of <code>group</code> to contain only those users specified in <code>array</code>. This function will fail if any user names contained in the array are not valid users on <code>server</code>. On successful completion <code>group</code> will contain only the users specified in <code>array</code>. Use the functions <code>GroupAddUser()/GroupDelUser()</code> to add and delete individual users from a group.</p>

<dl>

<dt id="server---Scalar-String17"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> on which to set the <code>group</code> membership.</p>

</dd>
<dt id="group---Scalar-String5"><code>group</code> - Scalar String</dt>
<dd>

<p>The <code>group</code> to set the membership of.</p>

</dd>
<dt id="array---Array-Reference5"><code>array</code> - Array Reference</dt>
<dd>

<p>The array containing the names of all users who will be members of <code>group</code>.</p>

</dd>
</dl>

<h1 id="NET-LOCAL-GROUP-FUNCTIONS1">NET LOCAL GROUP FUNCTIONS</h1>

<p>The <code>LocalGroup*()</code> functions operate on local groups. If these functions are run on a PDC then these functions operate on the domains local groups.</p>

<p>Administrator or Account Operator group membership is required to successfully execute most of these functions on a remote server or on a computer that has local security enabled.</p>

<p>The <code>server</code> field can be the empty string, in which case the function defaults to running on the local computer. If you leave this field blank then you should ensure that you are running the function on a PDC or BDC for your current domain. Use the support function <code>GetDCName()</code> to find out what the domain controller is, should you not be running this on the PDC.</p>

<p>The following functions are available.</p>

<h2 id="LocalGroupAdd-server-level-hash-error">LocalGroupAdd(server, level, hash, error)</h2>

<p>Adds the specified group. The name of the group is contained in the <code>name</code> key of <code>hash</code>.</p>

<dl>

<dt id="server---Scalar-String18"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> on which to add the group.</p>

</dd>
<dt id="level---Scalar-String1"><code>level</code> - Scalar String</dt>
<dd>

<p>The <code>level</code> of information contained in <code>hash</code>. This can be one of 0 or 1. See <a href="#LOCAL-GROUP-INFO-LEVELS">&quot;LOCAL GROUP INFO LEVELS&quot;</a>.</p>

</dd>
<dt id="hash---Hash-Reference6"><code>hash</code> - Hash Reference</dt>
<dd>

<p>A hash containing the required key/value pairs for <code>level</code>.</p>

</dd>
<dt id="error---Scalar-Int3"><code>error</code> - Scalar Int</dt>
<dd>

<p>Provides information on which field in <code>hash</code> wasn&#39;t properly specified. See <a href="#LOCAL-GROUP-FIELD-ERRORS">&quot;LOCAL GROUP FIELD ERRORS&quot;</a> for more information about what values this can take.</p>

</dd>
</dl>

<h2 id="LocalGroupAddMember">LocalGroupAddMember()</h2>

<p>This function is obsolete in the underlying API and has therefore not been implemented. Use <code>LocalGroupAddMembers</code> instead.</p>

<h2 id="LocalGroupAddMembers-server-group-array">LocalGroupAddMembers(server, group, array)</h2>

<p>Adds the specified users (members) to the local group. Unlike the API function <code>NetLocalGroupAddMembers()</code>, this function does not allow you to specify a level (internally it is hardcoded to 3). This was done to simplify the implementation. To add a &#39;local&#39; user, you need only specify the <code>name</code>. You can also specify users using the <code>DOMAIN\user</code> syntax.</p>

<dl>

<dt id="server---Scalar-String19"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> on which to add the members to <code>group</code>.</p>

</dd>
<dt id="group---Scalar-String6"><code>group</code> - Scalar String</dt>
<dd>

<p>The <code>group</code> to add the members to.</p>

</dd>
<dt id="array---Array-Reference6"><code>array</code> - Array Reference</dt>
<dd>

<p>The array containing the members to add to <code>group</code>.</p>

</dd>
</dl>

<h2 id="LocalGroupDel-server-group">LocalGroupDel(server, group)</h2>

<p>Delete the specified local group.</p>

<dl>

<dt id="server---Scalar-String20"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> on which to delete the named <code>group</code>.</p>

</dd>
<dt id="group--Scalar-String1"><code>group</code> -Scalar String</dt>
<dd>

<p>The <code>group</code> to delete.</p>

</dd>
</dl>

<h2 id="LocalGroupDelMember">LocalGroupDelMember()</h2>

<p>This function is obsolete in the underlying API and has therefore not been implemented. Use <code>LocalGroupDelMembers()</code> instead.</p>

<h2 id="LocalGroupDelMembers-server-group-array">LocalGroupDelMembers(server, group, array)</h2>

<p>Delete the specified users (members) of the local group. Unlike the API function <code>NetLocalGroupDelMembers()</code>, this function does not allow you to specify a level (internally it is hardcoded to 3). This was done to simplify the implementation. To delete a &#39;local&#39; user, you need only specify the <code>name</code>. You can also specify users using the <code>DOMAIN\user</code> syntax.</p>

<dl>

<dt id="server---Scalar-String21"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> on which to delete the members from <code>group</code>.</p>

</dd>
<dt id="group---Scalar-String7"><code>group</code> - Scalar String</dt>
<dd>

<p>The <code>group</code> to delete the members from.</p>

</dd>
<dt id="array---Array-Reference7"><code>array</code> - Array Reference</dt>
<dd>

<p>The array containing the members to delete from <code>group</code>.</p>

</dd>
</dl>

<h2 id="LocalGroupEnum-server-array">LocalGroupEnum(server, array)</h2>

<p>Enumerates all the local groups on the server. Unlike the API call <code>NetLocalGroupEnum()</code>, this function does not allow you to specify a level (internally it is hardcoded to 0). In Perl it is trivial to implement the equivalent function (should you need it).</p>

<dl>

<dt id="server---Scalar-String22"><code>server</code> - Scalar String</dt>
<dd>

<p>The server on which to enumerate the (local) <code>groups</code>.</p>

</dd>
<dt id="array---Array-Reference8"><code>array</code> - Array Reference</dt>
<dd>

<p>The array to hold the <code>group</code> names.</p>

</dd>
</dl>

<h2 id="LocalGroupGetInfo-server-group-level-hash">LocalGroupGetInfo(server, group, level, hash)</h2>

<p>Retrieves <code>level</code> information for <code>group</code>.</p>

<dl>

<dt id="server---Scalar-String23"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> from which to get the group information.</p>

</dd>
<dt id="group---Scalar-String8"><code>group</code> - Scalar String</dt>
<dd>

<p>The <code>group</code> whose information you wish to obtain.</p>

</dd>
<dt id="level---Scalar-Int5"><code>level</code> - Scalar Int</dt>
<dd>

<p>The <code>level</code> of information you wish to retrieve. This can be 0 or 1. See <a href="#LOCAL-GROUP-INFO-LEVELS">&quot;LOCAL GROUP INFO LEVELS&quot;</a>.</p>

</dd>
<dt id="hash---Hash-Reference7"><code>hash</code> - Hash Reference</dt>
<dd>

<p>The hash that will contain the information.</p>

</dd>
</dl>

<h2 id="LocalGroupGetMembers-server-group-hash">LocalGroupGetMembers(server, group, hash)</h2>

<p>Retrieves the users belonging to <code>group</code>. Unlike the API call <code>NetLocalGroupGetUsers()</code>, this function does not allow you to specify a level (internally it is hardcoded to 0). In Perl it is trivial to implement the equivalent function (should you need it).</p>

<dl>

<dt id="server---Scalar-String24"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> from which to retrieve the group information.</p>

</dd>
<dt id="group---Scalar-String9"><code>group</code> - Scalar String</dt>
<dd>

<p>The <code>group</code> whose users you wish to obtain.</p>

</dd>
<dt id="array---Array-Reference9"><code>array</code> - Array Reference</dt>
<dd>

<p>The array to hold the user names retrieved.</p>

</dd>
</dl>

<h2 id="LocalGroupSetInfo-server-level-hash-error">LocalGroupSetInfo(server, level, hash, error)</h2>

<p>Sets the information for <code>group</code> according to <code>level</code>.</p>

<dl>

<dt id="server---Scalar-String25"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> on which to set the <code>group</code> information.</p>

</dd>
<dt id="group---Scalar-String10"><code>group</code> - Scalar String</dt>
<dd>

<p>The <code>group</code> whose information you wish to set.</p>

</dd>
<dt id="level---Scalar-Int6"><code>level</code> - Scalar Int</dt>
<dd>

<p>The <code>level</code> of information you are supplying in <code>hash</code>. Level can be one of 0 or 1. See <a href="#LOCAL-GROUP-INFO-LEVELS">&quot;LOCAL GROUP INFO LEVELS&quot;</a>.</p>

</dd>
<dt id="hash---Hash-Reference8"><code>hash</code> - Hash Reference</dt>
<dd>

<p>The hash containing the required key/value pairs for <code>level</code>.</p>

</dd>
<dt id="error---Scalar-String1"><code>error</code> - Scalar String</dt>
<dd>

<p>On failure, the <code>error</code> parameter will contain a value which specifies which field caused the error. See <a href="#LOCAL-GROUP-FIELD-ERRORS">&quot;LOCAL GROUP FIELD ERRORS&quot;</a>.</p>

</dd>
</dl>

<h2 id="LocalGroupSetMembers">LocalGroupSetMembers()</h2>

<p>This function has not been implemented at present.</p>

<h1 id="NET-GET-FUNCTIONS1">NET GET FUNCTIONS</h1>

<h2 id="GetDCName-server-domain-domain-controller">GetDCName(server, domain, domain-controller)</h2>

<p>Gets the <code>domain-controller</code> name for <code>server</code> and <code>domain</code>.</p>

<dl>

<dt id="server---Scalar-String26"><code>server</code> - Scalar String</dt>
<dd>

<p>The <code>server</code> whose domain controller you wish to locate.</p>

</dd>
<dt id="domain---Scalar-String"><code>domain</code> - Scalar String</dt>
<dd>

<p>The <code>domain</code> that <code>server</code> is a member of whose domain-controller you wish the locate.</p>

</dd>
<dt id="domain-controller---Scalar-String-output"><code>domain-controller</code> - Scalar String (output)</dt>
<dd>

<p>The name of the <code>domain-controller</code> for the requested <code>domain</code>.</p>

</dd>
</dl>

<p>Note: This module does not implement the <code>NetGetAnyDCName()</code>API function as this is obsolete.</p>

<h1 id="USER-INFO-LEVELS">USER INFO LEVELS</h1>

<p>Most of the <code>User*()</code> functions take a <code>level</code> parameter. This <code>level</code> specifies how much detail the corresponding <code>hash</code> should contain (or in the case of a <code>UserGet*()</code> function, will contain after the call). The following <code>level</code> descriptions provide information on what fields should be present for a given level. See <a href="#USER-INFO-FIELDS">&quot;USER INFO FIELDS&quot;</a> for a description of the fields.</p>

<dl>

<dt id="Level-0">Level 0</dt>
<dd>

<p>name</p>

</dd>
<dt id="Level-1">Level 1</dt>
<dd>

<p>name, password, passwordAge, priv, homeDir, comment, flags, scriptPath</p>

</dd>
<dt id="Level-2">Level 2</dt>
<dd>

<p>name, password, passwordAge, priv, homeDir, comment, flags, scriptPath, authFlags, fullName, usrComment, parms, workstations, lastLogon, lastLogoff, acctExpires, maxStorage, unitsPerWeek, logonHours, badPwCount, numLogons, logonServer, countryCode, codePage</p>

</dd>
<dt id="Level-3">Level 3</dt>
<dd>

<p>name, password, passwordAge, priv, homeDir, comment, flags, scriptPath, authFlags, fullName, usrComment, parms, workstations, lastLogon, lastLogoff, acctExpires, maxStorage, unitsPerWeek, logonHours, badPwCount, numLogons, logonServer, countryCode, codePage, userId, primaryGroupId, profile, homeDirDrive, passwordExpired</p>

</dd>
<dt id="Level-4">Level 4</dt>
<dd>

<p>name, password, passwordAge, priv, homeDir, comment, flags, scriptPath, authFlags, fullName, usrComment, parms, workstations, lastLogon, lastLogoff, acctExpires, maxStorage, unitsPerWeek, logonHours, badPwCount, numLogons, logonServer, countryCode, codePage, userSid, primaryGroupId, profile, homeDirDrive, passwordExpired</p>

<p><b>Note:</b> This level is only supported on Windows Server 2003 and later.</p>

</dd>
<dt id="Level-10">Level 10</dt>
<dd>

<p>name, comment, usrComment, fullName</p>

</dd>
<dt id="Level-11">Level 11</dt>
<dd>

<p>name, comment, usrComment, fullName, priv, authFlags, passwordAge, homeDir, parms, lastLogon, lastLogoff, badPwCount, numLogons, logonServer, countryCode, workstations, maxStorage, unitsPerWeek, logonHours, codePage</p>

</dd>
<dt id="Level-20">Level 20</dt>
<dd>

<p>name, fullName, comment, flags, userId</p>

</dd>
<dt id="Level-21">Level 21</dt>
<dd>

<p>password (array)</p>

</dd>
<dt id="Level-22">Level 22</dt>
<dd>

<p>name, fullName, password (array), passwordAge, priv, homeDir, comment, flags, scriptPath, usrComment, workstations, lastLogon, lastLogoff, maxStorage, unitsPerWeek, logonHours, numLogons, logonServer, countryCode, codePage, parms</p>

</dd>
<dt id="Level-23">Level 23</dt>
<dd>

<p>userSid, flags, comment, fullName, name</p>

<p><b>Note:</b> This level is only supported on Windows Server 2003 and later.</p>

</dd>
<dt id="Level-1003">Level 1003</dt>
<dd>

<p>password</p>

</dd>
<dt id="Level-1005">Level 1005</dt>
<dd>

<p>priv</p>

</dd>
<dt id="Level-1006">Level 1006</dt>
<dd>

<p>homeDir</p>

</dd>
<dt id="Level-1007">Level 1007</dt>
<dd>

<p>comment</p>

</dd>
<dt id="Level-1008">Level 1008</dt>
<dd>

<p>flags</p>

</dd>
<dt id="Level-1009">Level 1009</dt>
<dd>

<p>scriptPath</p>

</dd>
<dt id="Level-1010">Level 1010</dt>
<dd>

<p>authFlags</p>

</dd>
<dt id="Level-1011">Level 1011</dt>
<dd>

<p>fullName</p>

</dd>
<dt id="Level-1012">Level 1012</dt>
<dd>

<p>usrComment</p>

</dd>
<dt id="Level-1013">Level 1013</dt>
<dd>

<p>parms</p>

</dd>
<dt id="Level-1014">Level 1014</dt>
<dd>

<p>workstations</p>

</dd>
<dt id="Level-1017">Level 1017</dt>
<dd>

<p>acctExpires</p>

</dd>
<dt id="Level-1018">Level 1018</dt>
<dd>

<p>maxStorage</p>

</dd>
<dt id="Level-1020">Level 1020</dt>
<dd>

<p>unitsPerWeek, logonHours</p>

</dd>
<dt id="Level-1023">Level 1023</dt>
<dd>

<p>logonServer</p>

</dd>
<dt id="Level-1024">Level 1024</dt>
<dd>

<p>countryCode</p>

</dd>
<dt id="Level-1025">Level 1025</dt>
<dd>

<p>codePage</p>

</dd>
<dt id="Level-1051">Level 1051</dt>
<dd>

<p>primaryGroupId</p>

</dd>
<dt id="Level-1052">Level 1052</dt>
<dd>

<p>profile</p>

</dd>
<dt id="Level-1053">Level 1053</dt>
<dd>

<p>homeDirDrive</p>

</dd>
</dl>

<h1 id="USER-INFO-FIELDS">USER INFO FIELDS</h1>

<p>The following is an alphabetical listing of each possible field, together with the data type that the field is expected to contain.</p>

<dl>

<dt id="acctExpires---Scalar-Int-UTC"><code>acctExpires</code> - Scalar Int (UTC)</dt>
<dd>

<p>The time (as the number of seconds since 00:00:00, 1st January 1970) when the account expires. A -1 in this field specifies that the account never expires.</p>

</dd>
<dt id="authFlags---Scalar-Int-See-USER_AUTH_FLAGS"><code>authFlags</code> - Scalar Int (See USER_AUTH_FLAGS).</dt>
<dd>

<p>The level of authority that this use has. The value this can take depends on the users group membership - this value is therefore read only and cannot be set using <code>UserAdd()</code> or <code>UserSetInfo()</code>. Its value can be one of:</p>

</dd>
</dl>

<pre><code>        User belongs to group           Flag value
        ---------------------           ----------
        Print Operators                 Win32API::Net::AF_OP_PRINT()
        Server Operators                Win32API::Net::AF_OP_SERVER()
        Account Operators               Win32API::Net::AF_OP_ACCOUNTS()</code></pre>

<dl>

<dt id="badPwCount---Scalar-Int"><code>badPwCount</code> - Scalar Int</dt>
<dd>

<p>The number of times that the user has failed to logon by specifying an incorrect password.</p>

</dd>
<dt id="codePage---Scalar-Int"><code>codePage</code> - Scalar Int</dt>
<dd>

<p>The code page that this user uses.</p>

</dd>
<dt id="comment---Scalar-String"><code>comment</code> - Scalar String</dt>
<dd>

<p>The comment associated with this user account. This can be any string (apparently of any length).</p>

</dd>
<dt id="countryCode---Scalar-Int"><code>countryCode</code> - Scalar Int</dt>
<dd>

<p>The country code that this user uses.</p>

</dd>
<dt id="flags---Scalar-Int-Bitwise-OR-of-USER_FLAGS"><code>flags</code> - Scalar Int (Bitwise OR of USER_FLAGS)</dt>
<dd>

<p>The flags for this user. See <a href="#USER-FLAGS">&quot;USER FLAGS&quot;</a>.</p>

</dd>
<dt id="fullName---Scalar-String"><code>fullName</code> - Scalar String</dt>
<dd>

<p>The users&#39; full name.</p>

</dd>
<dt id="homeDir---Scalar-String"><code>homeDir</code> - Scalar String</dt>
<dd>

<p>The home directory of the user. This can be either a UNC path or an absolute path (drive letter + path). Can be the empty string (&quot;&quot;).</p>

</dd>
<dt id="homeDirDrive---Scalar-String"><code>homeDirDrive</code> - Scalar String</dt>
<dd>

<p>The home directory drive that the users home directory is mapped to (assuming that the specified home directory is a UNC path).</p>

</dd>
<dt id="lastLogon---Scalar-Int-UTC"><code>lastLogon</code> - Scalar Int (UTC)</dt>
<dd>

<p>The time (as the number of seconds since 00:00:00, 1st January 1970) that the user last logged on.</p>

</dd>
<dt id="lastLogoff---Scalar-Int-UTC"><code>lastLogoff</code> - Scalar Int (UTC)</dt>
<dd>

<p>The time (as the number of seconds since 00:00:00, 1st January 1970) that the user last logged off .</p>

</dd>
<dt id="logonHours---Reference-to-Array-of-Integers-length-21-elements"><code>logonHours</code> - Reference to Array of Integers (length 21 elements)</dt>
<dd>

<p>The times at which the user can logon. This should be an integer array with 21 elements. Each element represents an 8 hour period and each bit represents an hour. Only the lower byte of each integer is used. If this is left undefined then no restrictions are placed on the account.</p>

</dd>
<dt id="logonServer---Scalar-String"><code>logonServer</code> - Scalar String</dt>
<dd>

<p>The logon server for this user. Under Windows NT, this value cannot be set and will always have the value &#39;\\*&#39; when queried.</p>

</dd>
<dt id="maxStorage---Scalar-Int"><code>maxStorage</code> - Scalar Int</dt>
<dd>

<p>The current release of Windows NT does not implement disk quotas so it is believed that the value of this key is ignored.</p>

</dd>
<dt id="name---Scalar-String"><code>name</code> - Scalar String</dt>
<dd>

<p>The user name that this request applies to. Most of the functions take the user name as a separate argument. In general, the user name provided should be the same as that in the one provided in the hash.</p>

</dd>
<dt id="numLogons---Scalar-Int"><code>numLogons</code> - Scalar Int</dt>
<dd>

<p>The number of times that the named user has successfully logged on to this machine/domain.</p>

</dd>
<dt id="parms---Scalar-String"><code>parms</code> - Scalar String</dt>
<dd>

<p>The value of this key can be used by applications. There are none known to the author that use it, although it could be used to hold administrative information.</p>

</dd>
<dt id="password---Scalar-String"><code>password</code> - Scalar String</dt>
<dd>

<p>The password to be set. The password is never returned in a <code>UserGet()</code> operation.</p>

</dd>
<dt id="password-array---16-bytes-array"><code>password (array)</code> - 16 bytes array</dt>
<dd>

<p>The password to be set. Specifies a one-way encrypted LAN Manager 2.x-compatible password.</p>

</dd>
<dt id="passwordAge---Scalar-Int-UTC"><code>passwordAge</code> - Scalar Int (UTC)</dt>
<dd>

<p>The current age of the password (stored as the number of seconds since 00:00:00, 1st January 1970).</p>

</dd>
<dt id="passwordExpired---Scalar-Int"><code>passwordExpired</code> - Scalar Int</dt>
<dd>

<p>The value of this key is used in two different ways. When queried via <code>UserGetInfo()</code> the return value is 0 is the password has not expired and 1 if it has. When setting the value via <code>UserAdd()</code> or <code>UserSetInfo()</code> a value of 0 indicates that the users&#39; password has not expired whereas a value of 1 will force the user to change their password at the next logon.</p>

</dd>
<dt id="primaryGroupId---Scalar-Int"><code>primaryGroupId</code> - Scalar Int</dt>
<dd>

<p>The id of the primary group that this user belongs to. When creating accounts with <code>UserAdd()</code> you should use a value of 0x201.</p>

</dd>
<dt id="priv---Scalar-Int-Bitwise-OR-of-USER_PRIVILEGE_FLAGS"><code>priv</code> - Scalar Int (Bitwise OR of USER_PRIVILEGE_FLAGS)</dt>
<dd>

<p>The privilege level that this user has. This is never returned from a <code>UserGet()</code> call. See <a href="#USER-PRIVILEGE-FLAGS">&quot;USER PRIVILEGE FLAGS&quot;</a>.</p>

</dd>
<dt id="profile---Scalar-String"><code>profile</code> - Scalar String</dt>
<dd>

<p>The profile that is associated with the named user. This can be UNC path, a local path or undefined.</p>

</dd>
<dt id="scriptPath---Scalar-String"><code>scriptPath</code> - Scalar String</dt>
<dd>

<p>The path to the logon script for this user. This should be specified as a relative path and will cause the logon script to be run from (relative location) in the logon servers export directory.</p>

</dd>
<dt id="unitsPerWeek---Scalar-Int"><code>unitsPerWeek</code> - Scalar Int</dt>
<dd>

<p>The value of this key represents the granularity of the logonHours array. Its use is beyond the scope of this package.</p>

</dd>
<dt id="usrComment---Scalar-String"><code>usrComment</code> - Scalar String</dt>
<dd>

<p>The user comment field (contrasted with the comment field ;-).</p>

</dd>
<dt id="userId---Scalar-Int"><code>userId</code> - Scalar Int</dt>
<dd>

<p>The user id associated with this user This value is generated by the system and cannot be set or changed using the <code>UserAdd()</code> or <code>UserSetInfo()</code> calls.</p>

</dd>
<dt id="userSid---Scalar-String"><code>userSid</code> - Scalar String</dt>
<dd>

<p>Secure Identifier that uniquely identifies the user. A SID has the format <i>S-R-I-S...</i>. In this notation, the literal character &quot;S&quot; identifies the series of digits as a SID, <i>R</i> is the revision level, <i>I</i> is the identifier-authority value, and <i>S...</i> is one or more subauthority values.</p>

</dd>
<dt id="workstations---Scalar-String"><code>workstations</code> - Scalar String</dt>
<dd>

<p>A comma-separated string containing up to 8 workstation that the named user can login to. Setting a value for this key will then allow the named user to login to only those computers named.</p>

</dd>
</dl>

<h1 id="USER-FLAGS">USER FLAGS</h1>

<p>The following is an alphabetical listing of the user flags. The <code>flags</code> key (see <a href="#USER-INFO-FIELDS">&quot;USER INFO FIELDS&quot;</a>) should be the bitwise OR of one or more of these values.</p>

<dl>

<dt id="UF_ACCOUNTDISABLE"><code>UF_ACCOUNTDISABLE()</code></dt>
<dd>

<p>This account has been disabled.</p>

</dd>
<dt id="UF_DONT_EXPIRE_PASSWD"><code>UF_DONT_EXPIRE_PASSWD()</code></dt>
<dd>

<p>Never expire the password on this account.</p>

</dd>
<dt id="UF_HOMEDIR_REQUIRED"><code>UF_HOMEDIR_REQUIRED()</code></dt>
<dd>

<p>A home directory must be specified (ignored for NT).</p>

</dd>
<dt id="UF_INTERDOMAIN_TRUST_ACCOUNT"><code>UF_INTERDOMAIN_TRUST_ACCOUNT()</code></dt>
<dd>

<p>The account represents a interdomain trust account.</p>

</dd>
<dt id="UF_LOCKOUT"><code>UF_LOCKOUT()</code></dt>
<dd>

<p>Lock out this account (or this account has been locked out due to security policy - i.e. badLogonCount is greater than your policy allows). This value can be cleared but not set by a <code>UserSetInfo()</code> call.</p>

</dd>
<dt id="UF_NORMAL_ACCOUNT"><code>UF_NORMAL_ACCOUNT()</code></dt>
<dd>

<p>The account is a normal user account.</p>

</dd>
<dt id="UF_PASSWD_CANT_CHANGE"><code>UF_PASSWD_CANT_CHANGE()</code></dt>
<dd>

<p>The password for this account cannot be changed (except by an Administrator using one of the above calls).</p>

</dd>
<dt id="UF_PASSWD_NOTREQD"><code>UF_PASSWD_NOTREQD()</code></dt>
<dd>

<p>A password is not required for this account.</p>

</dd>
<dt id="UF_SCRIPT"><code>UF_SCRIPT()</code></dt>
<dd>

<p>This &lt;strong&gt;must be set when creating account on Windows NT.</p>

</dd>
<dt id="UF_SERVER_TRUST_ACCOUNT"><code>UF_SERVER_TRUST_ACCOUNT()</code></dt>
<dd>

<p>The account represents a Windows NT Backup Domain Controller account in the domain.</p>

</dd>
<dt id="UF_TEMP_DUPLICATE_ACCOUNT"><code>UF_TEMP_DUPLICATE_ACCOUNT()</code></dt>
<dd>

<p>To quote the Microsoft Documentation &lt;em&gt;&amp;quot;This is an account for users whose primary account is in another domain. This account provides user access to this domain, but not to any domain that trusts this domain. The User Manager refers to this account type as a local user account.</p>

</dd>
<dt id="UF_WORKSTATION_TRUST_ACCOUNT"><code>UF_WORKSTATION_TRUST_ACCOUNT()</code></dt>
<dd>

<p>The account represents a computer account for a workstation or server in the domain.</p>

</dd>
</dl>

<p>Please note that these are implemented as functions and are therefore called in the same way as other functions. You should typically use them like:</p>

<pre><code>        <span class="variable">$ufScript</span> <span class="operator">=</span> <span class="variable">Win32API::Net::UF_SCRIPT</span><span class="operator">();</span>
</code></pre>

<h1 id="USER-PRIVILEGE-FLAGS">USER PRIVILEGE FLAGS</h1>

<p>These following values are used in the <code>priv</code> key. This field is never initialised on a <code>UserGet*()</code> call and once set cannot be changed in a <code>UserSetInfo()</code> call.</p>

<dl>

<dt id="USER_PRIV_ADMIN"><code>USER_PRIV_ADMIN()</code></dt>
<dd>

<p>Account is an administrative account.</p>

</dd>
<dt id="USER_PRIV_GUEST"><code>USER_PRIV_GUEST()</code></dt>
<dd>

<p>Account is a guest account.</p>

</dd>
<dt id="USER_PRIV_USER"><code>USER_PRIV_USER()</code></dt>
<dd>

<p>Account is a user account.</p>

</dd>
</dl>

<p>Please note that these are implemented as functions and are therefore called in the same way as other functions. You should typically use them like:</p>

<pre><code>        <span class="variable">$userPrivUser</span> <span class="operator">=</span> <span class="variable">Win32API::Net::USER_PRIV_USER</span><span class="operator">();</span>
</code></pre>

<h1 id="USER-ENUM-FILTER">USER ENUM FILTER</h1>

<p>These flags are used in the <code>UserEnum()</code> function to specify which accounts to retrieve. It should be a bitwise OR of some (or all) of the following.</p>

<dl>

<dt id="FILTER_TEMP_DUPLICATE_ACCOUNT"><code>FILTER_TEMP_DUPLICATE_ACCOUNT()</code></dt>
<dd>

<p>Show temporary duplicate account (one presumes).</p>

</dd>
<dt id="FILTER_NORMAL_ACCOUNT"><code>FILTER_NORMAL_ACCOUNT()</code></dt>
<dd>

<p>Show normal user account.</p>

</dd>
<dt id="FILTER_INTERDOMAIN_TRUST_ACCOUNT"><code>FILTER_INTERDOMAIN_TRUST_ACCOUNT()</code></dt>
<dd>

<p>Show interdomain trust accounts.</p>

</dd>
<dt id="FILTER_WORKSTATION_TRUST_ACCOUNT"><code>FILTER_WORKSTATION_TRUST_ACCOUNT()</code></dt>
<dd>

<p>Show workstation trust accounts.</p>

</dd>
<dt id="FILTER_SERVER_TRUST_ACCOUNT"><code>FILTER_SERVER_TRUST_ACCOUNT()</code></dt>
<dd>

<p>Show server trust accounts.</p>

</dd>
</dl>

<p>Please note that these are implemented as functions and are therefore called in the same way as other functions. You should typically use them like:</p>

<pre><code>        <span class="variable">$filterNormalAccounts</span> <span class="operator">=</span> <span class="variable">Win32API::Net::FILTER_NORMAL_ACCOUNT</span><span class="operator">();</span>
</code></pre>

<h1 id="USER-FIELD-ERRORS">USER FIELD ERRORS</h1>

<p>For the <code>User*()</code> functions that take an <code>error</code> parameter this variable will, on failure, contain one of the following constants. Note that the function may fail because more than one key/value was missing from the input hash. You will only find out about the first one that was incorrectly specified. This is only really useful in debugging.</p>

<dl>

<dt id="USER_ACCT_EXPIRES_PARMNUM"><code>USER_ACCT_EXPIRES_PARMNUM()</code></dt>
<dd>

<p><code>acctExpires</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_AUTH_FLAGS_PARMNUM"><code>USER_AUTH_FLAGS_PARMNUM()</code></dt>
<dd>

<p><code>authFlags</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_BAD_PW_COUNT_PARMNUM"><code>USER_BAD_PW_COUNT_PARMNUM()</code></dt>
<dd>

<p><code>badPasswordCount</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_CODE_PAGE_PARMNUM"><code>USER_CODE_PAGE_PARMNUM()</code></dt>
<dd>

<p><code>codePage</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_COMMENT_PARMNUM"><code>USER_COMMENT_PARMNUM()</code></dt>
<dd>

<p><code>comment</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_COUNTRY_CODE_PARMNUM"><code>USER_COUNTRY_CODE_PARMNUM()</code></dt>
<dd>

<p><code>countryCode</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_FLAGS_PARMNUM"><code>USER_FLAGS_PARMNUM()</code></dt>
<dd>

<p><code>flags</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_FULL_NAME_PARMNUM"><code>USER_FULL_NAME_PARMNUM()</code></dt>
<dd>

<p><code>fullName</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_HOME_DIR_DRIVE_PARMNUM"><code>USER_HOME_DIR_DRIVE_PARMNUM()</code></dt>
<dd>

<p><code>homeDirDrive</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_HOME_DIR_PARMNUM"><code>USER_HOME_DIR_PARMNUM()</code></dt>
<dd>

<p><code>homeDir</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_LAST_LOGOFF_PARMNUM"><code>USER_LAST_LOGOFF_PARMNUM()</code></dt>
<dd>

<p><code>lastLogoff</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_LAST_LOGON_PARMNUM"><code>USER_LAST_LOGON_PARMNUM()</code></dt>
<dd>

<p><code>lastLogon</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_LOGON_HOURS_PARMNUM"><code>USER_LOGON_HOURS_PARMNUM()</code></dt>
<dd>

<p><code>logonHours</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_LOGON_SERVER_PARMNUM"><code>USER_LOGON_SERVER_PARMNUM()</code></dt>
<dd>

<p><code>logonServer</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_MAX_STORAGE_PARMNUM"><code>USER_MAX_STORAGE_PARMNUM()</code></dt>
<dd>

<p><code>maxStorage</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_NAME_PARMNUM"><code>USER_NAME_PARMNUM()</code></dt>
<dd>

<p><code>name</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_NUM_LOGONS_PARMNUM"><code>USER_NUM_LOGONS_PARMNUM()</code></dt>
<dd>

<p><code>numLogons</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_PARMS_PARMNUM"><code>USER_PARMS_PARMNUM()</code></dt>
<dd>

<p><code>parms</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_PASSWORD_AGE_PARMNUM"><code>USER_PASSWORD_AGE_PARMNUM()</code></dt>
<dd>

<p><code>passwordAge</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_PASSWORD_PARMNUM"><code>USER_PASSWORD_PARMNUM()</code></dt>
<dd>

<p><code>password</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_PRIMARY_GROUP_PARMNUM"><code>USER_PRIMARY_GROUP_PARMNUM()</code></dt>
<dd>

<p><code>primaryGroup</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_PRIV_PARMNUM"><code>USER_PRIV_PARMNUM()</code></dt>
<dd>

<p><code>priv</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_PROFILE_PARMNUM"><code>USER_PROFILE_PARMNUM()</code></dt>
<dd>

<p><code>profile</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_SCRIPT_PATH_PARMNUM"><code>USER_SCRIPT_PATH_PARMNUM()</code></dt>
<dd>

<p><code>scriptPath</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_UNITS_PER_WEEK_PARMNUM"><code>USER_UNITS_PER_WEEK_PARMNUM()</code></dt>
<dd>

<p><code>unitPerWeek</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_USR_COMMENT_PARMNUM"><code>USER_USR_COMMENT_PARMNUM()</code></dt>
<dd>

<p><code>usrComment</code> field was absent or not correctly specified.</p>

</dd>
<dt id="USER_WORKSTATIONS_PARMNUM"><code>USER_WORKSTATIONS_PARMNUM()</code></dt>
<dd>

<p><code>workstations</code> field was absent or not correctly specified.</p>

</dd>
</dl>

<h1 id="GROUP-INFO-LEVELS">GROUP INFO LEVELS</h1>

<p>Some of the <code>Group*()</code> functions take a <code>level</code> parameter. This <code>level</code> specifies how much detail the corresponding <code>hash</code> should contain (or in the case of a <code>GroupGetInfo()</code> function, will contain after the call). The following <code>level</code> descriptions provide information on what fields should be present for a given level. See <a href="#GROUP-INFO-FIELDS">&quot;GROUP INFO FIELDS&quot;</a> for a description of the fields.</p>

<dl>

<dt id="Level-01"><code>Level 0</code></dt>
<dd>

<p>name.</p>

</dd>
<dt id="Level-12"><code>Level 1</code></dt>
<dd>

<p>name, comment.</p>

</dd>
<dt id="Level-24"><code>Level 2</code></dt>
<dd>

<p>name, comment, groupId, attributes.</p>

</dd>
<dt id="Level-31"><code>Level 3</code></dt>
<dd>

<p>name, comment, groupSid, attributes.</p>

</dd>
<dt id="Level-1002"><code>Level 1002</code></dt>
<dd>

<p>comment.</p>

</dd>
<dt id="Level-10051"><code>Level 1005</code></dt>
<dd>

<p>attributes.</p>

</dd>
</dl>

<h1 id="GROUP-INFO-FIELDS">GROUP INFO FIELDS</h1>

<dl>

<dt id="attributes---Scalar-Int"><code>attributes</code> - Scalar Int</dt>
<dd>

<p>The attributes of the group. These are no longer settable in Windows NT 4.0 and they are not currently supported in this package either.</p>

</dd>
<dt id="comment---Scalar-String1"><code>comment</code> - Scalar String</dt>
<dd>

<p>The <code>comment</code> that applies to this group. This is the only value that can be set via a GroupSetInfo call.</p>

</dd>
<dt id="groupId---Scalar-Int"><code>groupId</code> - Scalar Int</dt>
<dd>

<p>The groups Id.</p>

</dd>
<dt id="groupSid"><code>groupSid</code></dt>
<dd>

<p>Secure Identifier that uniquely identifies the group. A SID has the format <i>S-R-I-S...</i>. In this notation, the literal character &quot;S&quot; identifies the series of digits as a SID, <i>R</i> is the revision level, <i>I</i> is the identifier-authority value, and <i>S...</i> is one or more subauthority values.</p>

</dd>
<dt id="name---Scalar-String1"><code>name</code> - Scalar String</dt>
<dd>

<p>The groups name.</p>

</dd>
</dl>

<h1 id="GROUP-FIELD-ERRORS">GROUP FIELD ERRORS</h1>

<p>For the <code>Group*()</code> functions that take an <code>error</code> parameter this variable will, on failure, contain one of the following constants. Note that the function may fail because more than one key/value was missing from the input hash. You will only find out about the first one that was incorrectly specified. This is only really useful for debugging purposes.</p>

<dl>

<dt id="GROUP_ATTRIBUTES_PARMNUM"><code>GROUP_ATTRIBUTES_PARMNUM()</code></dt>
<dd>

<p><code>attributes</code> field was absent or not correctly specified.</p>

</dd>
<dt id="GROUP_COMMENT_PARMNUM"><code>GROUP_COMMENT_PARMNUM()</code></dt>
<dd>

<p><code>comment</code> field was absent or not correctly specified.</p>

</dd>
<dt id="GROUP_NAME_PARMNUM"><code>GROUP_NAME_PARMNUM()</code></dt>
<dd>

<p><code>name</code> field was absent or not correctly specified.</p>

</dd>
</dl>

<h1 id="GROUP-USERS-INFO-LEVELS">GROUP USERS INFO LEVELS</h1>

<p>The <code>GroupGetUsers()</code> function can take a level of 0 or 1. These will return the following:</p>

<dl>

<dt id="Level-02"><code>Level 0</code></dt>
<dd>

<p>name.</p>

</dd>
<dt id="Level-13"><code>Level 1</code></dt>
<dd>

<p>name, attributes.</p>

</dd>
</dl>

<h1 id="GROUP-USERS-INFO-FIELDS">GROUP USERS INFO FIELDS</h1>

<dl>

<dt id="name---Scalar-String2"><code>name</code> - Scalar String</dt>
<dd>

<p>The user&#39;s name.</p>

</dd>
<dt id="attributes---Scalar-Int1"><code>attributes</code> - Scalar Int</dt>
<dd>

<p>The attributes of the group. These are no longer settable in Windows NT 4.0 and they are not currently supported in this package either.</p>

</dd>
</dl>

<h1 id="LOCAL-GROUP-INFO-LEVELS">LOCAL GROUP INFO LEVELS</h1>

<dl>

<dt id="Level-03"><code>Level 0</code></dt>
<dd>

<p>name</p>

</dd>
<dt id="Level-14"><code>Level 1</code></dt>
<dd>

<p>name, comment</p>

</dd>
<dt id="Level-10021"><code>Level 1002</code></dt>
<dd>

<p>comment</p>

</dd>
</dl>

<h1 id="LOCAL-GROUP-INFO-FIELDS">LOCAL GROUP INFO FIELDS</h1>

<dl>

<dt id="name---Scalar-String3"><code>name</code> - Scalar String</dt>
<dd>

<p>The groups name</p>

</dd>
<dt id="comment---Scalar-String2"><code>comment</code> - Scalar String</dt>
<dd>

<p>The groups &#39;comment&#39;</p>

</dd>
</dl>

<h1 id="LOCAL-GROUP-FIELD-ERRORS">LOCAL GROUP FIELD ERRORS</h1>

<p>For the <code>LocalGroup*()</code> functions that take an <code>error</code> parameter this variable will, on failure, contain one of the following constants. Note that the function may fail because more than one key/value was missing or incorrectly specified in the input hash. You will only find out about the first one that was incorrectly specified. This is only really useful for debugging purposes.</p>

<dl>

<dt id="LOCALGROUP_NAME_PARMNUM"><code>LOCALGROUP_NAME_PARMNUM()</code></dt>
<dd>

<p>The <code>name</code> field was absent or not correctly specified.</p>

</dd>
<dt id="LOCALGROUP_COMMENT_PARMNUM"><code>LOCALGROUP_COMMENT_PARMNUM()</code></dt>
<dd>

<p>The <code>comment</code> field was absent or not correctly specified.</p>

</dd>
</dl>

<h1 id="EXAMPLES">EXAMPLES</h1>

<p>The following example shows how you can create a function in Perl that has the same functionality as the <code>NetUserEnum()</code> API call. The Perl version doesn&#39;t have the level parameter so you must first use the <code>UserEnum()</code> function to retrieve all the account names and then iterate through the returned array issuing <code>UserGetInfo()</code> calls.</p>

<pre><code>    <span class="keyword">sub</span><span class="variable"> userEnumAtLevel </span><span class="operator">{</span>
       <span class="keyword">my</span><span class="operator">(</span><span class="variable">$server</span><span class="operator">,</span> <span class="variable">$level</span><span class="operator">,</span> <span class="variable">$filter</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">@_</span><span class="operator">;</span>
       <span class="keyword">my</span><span class="operator">(</span><span class="variable">@array</span><span class="operator">);</span>
       <span class="variable">Win32API::Net::UserEnum</span><span class="operator">(</span><span class="variable">$server</span><span class="operator">,</span> <span class="operator">\</span><span class="variable">@array</span><span class="operator">,</span> <span class="variable">$filter</span><span class="operator">);</span>
       <span class="keyword">for</span> <span class="variable">$user</span> <span class="operator">(</span><span class="variable">@array</span><span class="operator">)</span> <span class="operator">{</span>
          <span class="variable">Win32API::Net::UserGetInfo</span><span class="operator">(</span><span class="variable">$server</span><span class="operator">,</span> <span class="variable">$user</span><span class="operator">,</span> <span class="variable">$level</span><span class="operator">,</span> <span class="operator">\</span><span class="variable">%hash</span><span class="operator">);</span>
          <span class="keyword">print</span> <span class="string">"This could access all level </span><span class="variable">$level</span><span class="string"> settings for </span><span class="variable">$user</span><span class="string"> - eg fullName </span><span class="variable">$hash</span><span class="string">{fullName}\n"</span><span class="operator">;</span>
       <span class="operator">}</span>
    <span class="operator">}</span>
    <span class="variable">userEnumAtLevel</span><span class="operator">(</span><span class="string">""</span><span class="operator">,</span> <span class="number">2</span><span class="operator">,</span> <span class="number">0</span><span class="operator">);</span>
</code></pre>

<h1 id="AUTHOR">AUTHOR</h1>

<p>Bret Giddings, &lt;bret@essex.ac.uk&gt;</p>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<p><code>perl(1)</code></p>

<h1 id="ACKNOWEDGEMENTS">ACKNOWEDGEMENTS</h1>

<p>This work was built upon work done by HiP Communications along with modifications to HiPs code by &lt;michael@ecel.uwa.edu.au&gt; and &lt;rothd@roth.net&gt;. In addition, I would like to thank Jenny Emby at GEC Marconi, U.K. for proof reading this manual page and making many suggestions that have led to its current layout. Last but not least I would like to thank Larry Wall and all the other Perl contributors for making this truly wonderful language.</p>


</body>

</html>


