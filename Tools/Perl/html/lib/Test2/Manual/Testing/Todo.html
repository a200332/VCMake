<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../../../displayToc.js"></script>
<script language="JavaScript" src="../../../../tocParas.js"></script>
<script language="JavaScript" src="../../../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../scineplex.css">
<title></title>
<link rel="stylesheet" href="../../../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#THE-TOOL">THE TOOL</a>
    <ul>
      <li><a href="#TODO-BLOCK">TODO BLOCK</a></li>
      <li><a href="#TODO-VARIABLE">TODO VARIABLE</a></li>
    </ul>
  </li>
  <li><a href="#MANUAL-TODO-EVENTS">MANUAL TODO EVENTS</a></li>
  <li><a href="#HOW-THE-TODO-TOOLS-WORK-UNDER-THE-HOOD">HOW THE TODO TOOLS WORK UNDER THE HOOD</a></li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
  <li><a href="#SOURCE">SOURCE</a></li>
  <li><a href="#MAINTAINERS">MAINTAINERS</a></li>
  <li><a href="#AUTHORS">AUTHORS</a></li>
  <li><a href="#COPYRIGHT">COPYRIGHT</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Test2::Manual::Testing::Todo - Tutorial for marking tests as TODO.</p>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>This tutorial covers the process of marking tests as TODO. It also describes how TODO works under the hood.</p>

<h1 id="THE-TOOL">THE TOOL</h1>

<pre><code>    <span class="keyword">use</span> <span class="variable">Test2::Tools::Basic</span> <span class="string">qw/todo/</span><span class="operator">;</span>
</code></pre>

<h2 id="TODO-BLOCK">TODO BLOCK</h2>

<p>This form is low-magic. All tests inside the block are marked as todo, tests outside the block are not todo. You do not need to do any variable management. The flaw with this form is that it adds a couple levels to the stack, which can break some high-magic tests.</p>

<p>Overall this is the preferred form unless you have a special case that requires the variable form.</p>

<pre><code>    <span class="variable">todo</span> <span class="string">"Reason for the todo"</span> <span class="operator">=&gt;</span> <span class="keyword">sub</span><span class="variable"> </span><span class="operator">{</span>
        <span class="variable">ok</span><span class="operator">(</span><span class="number">0</span><span class="operator">,</span> <span class="string">"fail but todo"</span><span class="operator">);</span>
        <span class="operator">...</span>
    <span class="operator">};</span>
</code></pre>

<h2 id="TODO-VARIABLE">TODO VARIABLE</h2>

<p>This form maintains the todo scope for the life of the variable. This is useful for tests that are sensitive to scope changes. This closely emulates the <a href="../../../../lib/Test/More.html">Test::More</a> style which localized the <code>$TODO</code> package variable. Once the variable is destroyed (set it to undef, scope end, etc) the TODO state ends.</p>

<pre><code>    <span class="keyword">my</span> <span class="variable">$todo</span> <span class="operator">=</span> <span class="variable">todo</span> <span class="string">"Reason for the todo"</span><span class="operator">;</span>
    <span class="variable">ok</span><span class="operator">(</span><span class="number">0</span><span class="operator">,</span> <span class="string">"fail but todo"</span><span class="operator">);</span>
    <span class="operator">...</span>
    <span class="variable">$todo</span> <span class="operator">=</span> <span class="keyword">undef</span><span class="operator">;</span>
</code></pre>

<h1 id="MANUAL-TODO-EVENTS">MANUAL TODO EVENTS</h1>

<pre><code>    <span class="keyword">use</span> <span class="variable">Test2::API</span> <span class="string">qw/context/</span><span class="operator">;</span>
    
    <span class="keyword">sub</span><span class="variable"> todo_ok </span><span class="operator">{</span>
        <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$bool</span><span class="operator">,</span> <span class="variable">$name</span><span class="operator">,</span> <span class="variable">$todo</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">@_</span><span class="operator">;</span>
    
        <span class="keyword">my</span> <span class="variable">$ctx</span> <span class="operator">=</span> <span class="variable">context</span><span class="operator">();</span>
        <span class="variable">$ctx</span><span class="operator">-&gt;</span><span class="variable">send_event</span><span class="operator">(</span><span class="string">'Ok'</span><span class="operator">,</span> <span class="string">pass</span> <span class="operator">=&gt;</span> <span class="variable">$bool</span><span class="operator">,</span> <span class="string">effective_pass</span> <span class="operator">=&gt;</span> <span class="number">1</span><span class="operator">,</span> <span class="string">todo</span> <span class="operator">=&gt;</span> <span class="variable">$todo</span><span class="operator">);</span>
        <span class="variable">$ctx</span><span class="operator">-&gt;</span><span class="variable">release</span><span class="operator">;</span>
    
        <span class="keyword">return</span> <span class="variable">$bool</span><span class="operator">;</span>
    <span class="operator">}</span>
</code></pre>

<p>The <a href="../../../../lib/Test2/Event/Ok.html">Test2::Event::Ok</a> event has a <code>todo</code> field which should have the todo reason. The event also has the <code>pass</code> and <code>effective_pass</code> fields. The <code>pass</code> field is the actual pass/fail value. The <code>effective_pass</code> is used to determine if the event is an actual failure (should always be set tot true with todo).</p>

<h1 id="HOW-THE-TODO-TOOLS-WORK-UNDER-THE-HOOD">HOW THE TODO TOOLS WORK UNDER THE HOOD</h1>

<p>The <a href="../../../../lib/Test2/Todo.html">Test2::Todo</a> library gets the current <a href="../../../../lib/Test2/Hub.html">Test2::Hub</a> instance and adds a filter. The filter that is added will set the todo and effective pass fields on any <a href="../../../../lib/Test2/Event/Ok.html">Test2::Event::Ok</a> events that pass through the hub. The filter also converts <a href="../../../../lib/Test2/Event/Diag.html">Test2::Event::Diag</a> events into <a href="../../../../lib/Test2/Event/Note.html">Test2::Event::Note</a> events.</p>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<p><a href="../../../../lib/Test2/Manual.html">Test2::Manual</a> - Primary index of the manual.</p>

<h1 id="SOURCE">SOURCE</h1>

<p>The source code repository for Test2-Manual can be found at <i>http://github.com/Test-More/Test2-Manual/</i>.</p>

<h1 id="MAINTAINERS">MAINTAINERS</h1>

<dl>

<dt id="Chad-Granum-exodist-cpan.org">Chad Granum &lt;exodist@cpan.org&gt;</dt>
<dd>

</dd>
</dl>

<h1 id="AUTHORS">AUTHORS</h1>

<dl>

<dt id="Chad-Granum-exodist-cpan.org1">Chad Granum &lt;exodist@cpan.org&gt;</dt>
<dd>

</dd>
</dl>

<h1 id="COPYRIGHT">COPYRIGHT</h1>

<p>Copyright 2017 Chad Granum &lt;exodist@cpan.org&gt;.</p>

<p>This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>

<p>See <i>http://dev.perl.org/licenses/</i></p>


</body>

</html>


