<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../displayToc.js"></script>
<script language="JavaScript" src="../tocParas.js"></script>
<script language="JavaScript" src="../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../scineplex.css">
<title></title>
<link rel="stylesheet" href="../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SEE">SEE</a></li>
  <li><a href="#QUICK-REFERENCE">QUICK REFERENCE</a>
    <ul>
      <li><a href="#PRIMALITY">PRIMALITY</a></li>
      <li><a href="#PROBABLE-PRIME-TESTS">PROBABLE PRIME TESTS</a></li>
      <li><a href="#PRIMES">PRIMES</a></li>
      <li><a href="#FACTORING">FACTORING</a></li>
      <li><a href="#ITERATORS">ITERATORS</a></li>
      <li><a href="#RANDOM-NUMBERS">RANDOM NUMBERS</a></li>
      <li><a href="#RANDOM-PRIMES">RANDOM PRIMES</a></li>
      <li><a href="#LISTS">LISTS</a></li>
      <li><a href="#MATH">MATH</a></li>
      <li><a href="#NON-INTEGER-MATH">NON-INTEGER MATH</a></li>
      <li><a href="#SUPPORT">SUPPORT</a></li>
    </ul>
  </li>
  <li><a href="#COPYRIGHT">COPYRIGHT</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>ntheory - Number theory utilities</p>

<h1 id="SEE">SEE</h1>

<p>See <a href="../lib/Math/Prime/Util.html">Math::Prime::Util</a> for complete documentation.</p>

<h1 id="QUICK-REFERENCE">QUICK REFERENCE</h1>

<p>Tags: :all to import almost all functions :rand to import rand, srand, irand, irand64</p>

<h2 id="PRIMALITY">PRIMALITY</h2>

<pre><code>  is_prob_prime(n)                    primality test (BPSW)
  is_prime(n)                         primality test (BPSW + extra)
  is_provable_prime(n)                primality test with proof
  is_provable_prime_with_cert(n)      primality test: (isprime,cert)
  prime_certificate(n)                as above with just certificate
  verify_prime(cert)                  verify a primality certificate
  is_mersenne_prime(p)                is 2^p-1 prime or composite
  is_aks_prime(n)                     AKS deterministic test (slow)
  is_ramanujan_prime(n)               is n a Ramanujan prime</code></pre>

<h2 id="PROBABLE-PRIME-TESTS">PROBABLE PRIME TESTS</h2>

<pre><code>  is_pseudoprime(n,bases)                  Fermat probable prime test
  is_euler_pseudoprime(n,bases)            Euler test to bases
  is_euler_plumb_pseudoprime(n)            Euler Criterion test
  is_strong_pseudoprime(n,bases)           Miller-Rabin test to bases
  is_lucas_pseudoprime(n)                  Lucas test
  is_strong_lucas_pseudoprime(n)           strong Lucas test
  is_almost_extra_strong_lucas_pseudoprime(n, [incr])   AES Lucas test
  is_extra_strong_lucas_pseudoprime(n)     extra strong Lucas test
  is_frobenius_pseudoprime(n, [a,b])       Frobenius quadratic test
  is_frobenius_underwood_pseudoprime(n)    combined PSP and Lucas
  is_frobenius_khashin_pseudoprime(n)      Khashin&#39;s 2013 Frobenius test
  is_perrin_pseudoprime(n [,r])            Perrin test
  is_catalan_pseudoprime(n)                Catalan test
  is_bpsw_prime(n)                         combined SPSP-2 and ES Lucas
  miller_rabin_random(n, ntests)           perform random-base MR tests</code></pre>

<h2 id="PRIMES">PRIMES</h2>

<pre><code>  primes([start,] end)                array ref of primes
  twin_primes([start,] end)           array ref of twin primes
  ramanujan_primes([start,] end)      array ref of Ramanujan primes
  sieve_prime_cluster(start, end, @C) list of prime k-tuples
  sieve_range(n, width, depth)        sieve out small factors to depth
  next_prime(n)                       next prime &gt; n
  prev_prime(n)                       previous prime &lt; n
  prime_count(n)                      count of primes &lt;= n
  prime_count(start, end)             count of primes in range
  prime_count_lower(n)                fast lower bound for prime count
  prime_count_upper(n)                fast upper bound for prime count
  prime_count_approx(n)               fast approximate count of primes
  nth_prime(n)                        the nth prime (n=1 returns 2)
  nth_prime_lower(n)                  fast lower bound for nth prime
  nth_prime_upper(n)                  fast upper bound for nth prime
  nth_prime_approx(n)                 fast approximate nth prime
  twin_prime_count(n)                 count of twin primes &lt;= n
  twin_prime_count(start, end)        count of twin primes in range
  twin_prime_count_approx(n)          fast approx count of twin primes
  nth_twin_prime(n)                   the nth twin prime (n=1 returns 3)
  nth_twin_prime_approx(n)            fast approximate nth twin prime
  ramanujan_prime_count(n)            count of Ramanujan primes &lt;= n
  ramanujan_prime_count(start, end)   count of Ramanujan primes in range
  ramanujan_prime_count_lower(n)      fast lower bound for Ramanujan count
  ramanujan_prime_count_upper(n)      fast upper bound for Ramanujan count
  ramanujan_prime_count_approx(n)     fast approximate Ramanujan count
  nth_ramanujan_prime(n)              the nth Ramanujan prime (Rn)
  nth_ramanujan_prime_lower(n)        fast lower bound for Rn
  nth_ramanujan_prime_upper(n)        fast upper bound for Rn
  nth_ramanujan_prime_approx(n)       fast approximate Rn
  legendre_phi(n,a)                   # below n not div by first a primes
  inverse_li(n)                       integer inverse logarithmic integral
  prime_precalc(n)                    precalculate primes to n
  sum_primes([start,] end)            return summation of primes in range
  print_primes(start,end[,fd])        print primes to stdout or fd</code></pre>

<h2 id="FACTORING">FACTORING</h2>

<pre><code>  <span class="variable">factor</span><span class="operator">(</span><span class="variable">n</span><span class="operator">)</span>                           <span class="variable">array</span> <span class="variable">of</span> <span class="variable">prime</span> <span class="variable">factors</span> <span class="variable">of</span> <span class="variable">n</span>
  <span class="variable">factor_exp</span><span class="operator">(</span><span class="variable">n</span><span class="operator">)</span>                       <span class="variable">array</span> <span class="variable">of</span> <span class="operator">[</span><span class="variable">p</span><span class="operator">,</span><span class="variable">k</span><span class="operator">]</span> <span class="variable">factors</span> <span class="variable">p</span><span class="operator">^</span><span class="variable">k</span>
  <span class="variable">divisors</span><span class="operator">(</span><span class="variable">n</span><span class="operator">)</span>                         <span class="variable">array</span> <span class="variable">of</span> <span class="variable">divisors</span> <span class="variable">of</span> <span class="variable">n</span>
  <span class="variable">divisor_sum</span><span class="operator">(</span><span class="variable">n</span><span class="operator">)</span>                      <span class="variable">sum</span> <span class="variable">of</span> <span class="variable">divisors</span>
  <span class="variable">divisor_sum</span><span class="operator">(</span><span class="variable">n</span><span class="operator">,</span><span class="variable">k</span><span class="operator">)</span>                    <span class="variable">sum</span> <span class="variable">of</span> <span class="variable">k</span><span class="operator">-</span><span class="variable">th</span> <span class="variable">power</span> <span class="variable">of</span> <span class="variable">divisors</span>
  <span class="variable">divisor_sum</span><span class="operator">(</span><span class="variable">n</span><span class="operator">,</span><span class="keyword">sub</span><span class="operator">{...})</span>             <span class="variable">sum</span> <span class="variable">of</span> <span class="variable">code</span> <span class="variable">run</span> <span class="keyword">for</span> <span class="keyword">each</span> <span class="variable">divisor</span>
  <span class="variable">znlog</span><span class="operator">(</span><span class="variable">a</span><span class="operator">,</span> <span class="variable">g</span><span class="operator">,</span> <span class="variable">p</span><span class="operator">)</span>                      <span class="variable">solve</span> <span class="variable">k</span> <span class="variable">in</span> <span class="variable">a</span> <span class="operator">=</span> <span class="variable">g</span><span class="operator">^</span><span class="variable">k</span> <span class="variable">mod</span> <span class="variable">p</span>
</code></pre>

<h2 id="ITERATORS">ITERATORS</h2>

<pre><code>  <span class="variable">forprimes</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span> <span class="operator">[</span><span class="variable">start</span><span class="operator">,</span><span class="operator">]</span> <span class="variable">end</span>      <span class="variable">loop</span> <span class="variable">over</span> <span class="variable">primes</span> <span class="variable">in</span> <span class="variable">range</span>
  <span class="variable">forcomposites</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span> <span class="operator">[</span><span class="variable">start</span><span class="operator">,</span><span class="operator">]</span> <span class="variable">end</span>  <span class="variable">loop</span> <span class="variable">over</span> <span class="variable">composites</span> <span class="variable">in</span> <span class="variable">range</span>
  <span class="variable">foroddcomposites</span> <span class="operator">{...}</span> <span class="operator">[</span><span class="variable">start</span><span class="operator">,</span><span class="operator">]</span> <span class="variable">end</span> <span class="variable">loop</span> <span class="variable">over</span> <span class="variable">odd</span> <span class="variable">composites</span> <span class="variable">in</span> <span class="variable">range</span>
  <span class="variable">fordivisors</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span> <span class="variable">n</span>               <span class="variable">loop</span> <span class="variable">over</span> <span class="variable">the</span> <span class="variable">divisors</span> <span class="variable">of</span> <span class="variable">n</span>
  <span class="variable">forpart</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span> <span class="variable">n</span> <span class="operator">[</span><span class="operator">,</span><span class="operator">{</span><span class="operator">...</span><span class="operator">}]</span>          <span class="variable">loop</span> <span class="variable">over</span> <span class="variable">integer</span> <span class="variable">partitions</span>
  <span class="variable">forcomp</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span> <span class="variable">n</span> <span class="operator">[</span><span class="operator">,</span><span class="operator">{</span><span class="operator">...</span><span class="operator">}]</span>          <span class="variable">loop</span> <span class="variable">over</span> <span class="variable">integer</span> <span class="variable">compositions</span>
  <span class="variable">forcomb</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span> <span class="variable">n</span><span class="operator">,</span> <span class="variable">k</span>                <span class="variable">loop</span> <span class="variable">over</span> <span class="variable">combinations</span>
  <span class="variable">forperm</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span> <span class="variable">n</span>                   <span class="variable">loop</span> <span class="variable">over</span> <span class="variable">permutations</span>
  <span class="variable">formultiperm</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span> <span class="operator">\</span><span class="variable">@n</span>            <span class="variable">loop</span> <span class="variable">over</span> <span class="variable">multiset</span> <span class="variable">permutations</span>
  <span class="variable">forderange</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span> <span class="variable">n</span>                <span class="variable">loop</span> <span class="variable">over</span> <span class="variable">derangements</span>
  <span class="variable">prime_iterator</span>                      <span class="variable">returns</span> <span class="variable">a</span> <span class="variable">simple</span> <span class="variable">prime</span> <span class="variable">iterator</span>
  <span class="variable">prime_iterator_object</span>               <span class="variable">returns</span> <span class="variable">a</span> <span class="variable">prime</span> <span class="variable">iterator</span> <span class="variable">object</span>
  <span class="variable">lastfor</span>                             <span class="variable">stop</span> <span class="variable">iteration</span> <span class="variable">of</span> <span class="keyword">for</span><span class="operator">....</span> <span class="variable">loop</span>
</code></pre>

<h2 id="RANDOM-NUMBERS">RANDOM NUMBERS</h2>

<pre><code>  irand                               random 32-bit integer
  irand64                             random 64-bit integer
  drand([limit])                      random NV in [0,1) or [0,limit)
  random_bytes(n)                     string with n random bytes
  entropy_bytes(n)                    string with n entropy-source bytes
  urandomb(n)                         random integer less than 2^n
  urandomm(n)                         random integer less than n
  csrand(data)                        seed the CSPRNG with binary data
  srand([seed])                       simple seed (exported with :rand)
  rand([limit])                       alias for drand (exported with :rand)</code></pre>

<h2 id="RANDOM-PRIMES">RANDOM PRIMES</h2>

<pre><code>  random_prime([start,] end)          random prime in a range
  random_ndigit_prime(n)              random prime with n digits
  random_nbit_prime(n)                random prime with n bits
  random_strong_prime(n)              random strong prime with n bits
  random_proven_prime(n)              random n-bit prime with proof
  random_proven_prime_with_cert(n)    as above and include certificate
  random_maurer_prime(n)              random n-bit prime w/ Maurer&#39;s alg.
  random_maurer_prime_with_cert(n)    as above and include certificate
  random_shawe_taylor_prime(n)        random n-bit prime with S-T alg.
  random_shawe_taylor_prime_with_cert(n) as above including certificate
  random_unrestricted_semiprime(n)    random n-bit semiprime
  random_semiprime(n)                 as above with equal size factors</code></pre>

<h2 id="LISTS">LISTS</h2>

<pre><code>  <span class="variable">vecsum</span><span class="operator">(</span><span class="variable">@list</span><span class="operator">)</span>                       <span class="variable">integer</span> <span class="variable">sum</span> <span class="variable">of</span> <span class="variable">list</span>
  <span class="variable">vecprod</span><span class="operator">(</span><span class="variable">@list</span><span class="operator">)</span>                      <span class="variable">integer</span> <span class="variable">product</span> <span class="variable">of</span> <span class="variable">list</span>
  <span class="variable">vecmin</span><span class="operator">(</span><span class="variable">@list</span><span class="operator">)</span>                       <span class="variable">minimum</span> <span class="variable">of</span> <span class="variable">list</span> <span class="variable">of</span> <span class="variable">integers</span>
  <span class="variable">vecmax</span><span class="operator">(</span><span class="variable">@list</span><span class="operator">)</span>                       <span class="variable">maximum</span> <span class="variable">of</span> <span class="variable">list</span> <span class="variable">of</span> <span class="variable">integers</span>
  <span class="variable">vecextract</span><span class="operator">(\</span><span class="variable">@list</span><span class="operator">,</span> <span class="variable">mask</span><span class="operator">)</span>            <span class="keyword">select</span> <span class="variable">from</span> <span class="variable">list</span> <span class="variable">based</span> <span class="variable">on</span> <span class="variable">mask</span>
  <span class="variable">vecreduce</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span> <span class="variable">@list</span>             <span class="variable">reduce</span> <span class="operator">/</span> <span class="variable">left</span> <span class="variable">fold</span> <span class="variable">applied</span> <span class="variable">to</span> <span class="variable">list</span>
  <span class="variable">vecall</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span> <span class="variable">@list</span>                <span class="keyword">return</span> <span class="variable">true</span> <span class="keyword">if</span> <span class="variable">all</span> <span class="variable">are</span> <span class="variable">true</span>
  <span class="variable">vecany</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span> <span class="variable">@list</span>                <span class="keyword">return</span> <span class="variable">true</span> <span class="keyword">if</span> <span class="variable">any</span> <span class="variable">are</span> <span class="variable">true</span>
  <span class="variable">vecnone</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span> <span class="variable">@list</span>               <span class="keyword">return</span> <span class="variable">true</span> <span class="keyword">if</span> <span class="variable">none</span> <span class="variable">are</span> <span class="variable">true</span>
  <span class="variable">vecnotall</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span> <span class="variable">@list</span>             <span class="keyword">return</span> <span class="variable">true</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable">all</span> <span class="variable">are</span> <span class="variable">true</span>
  <span class="variable">vecfirst</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span> <span class="variable">@list</span>              <span class="keyword">return</span> <span class="variable">first</span> <span class="variable">value</span> <span class="variable">that</span> <span class="variable">evals</span> <span class="variable">true</span>
  <span class="variable">vecfirstidx</span> <span class="operator">{</span> <span class="operator">...</span> <span class="operator">}</span> <span class="variable">@list</span>           <span class="keyword">return</span> <span class="variable">first</span> <span class="keyword">index</span> <span class="variable">that</span> <span class="variable">evals</span> <span class="variable">true</span>
</code></pre>

<h2 id="MATH">MATH</h2>

<pre><code>  todigits(n[,base[,len]])            convert n to digit array in base
  todigitstring(n[,base[,len]])       convert n to string in base
  fromdigits(\@d,[,base])             convert base digit vector to number
  fromdigits(str,[,base])             convert base digit string to number
  sumdigits(n)                        sum of digits, with optional base
  is_square(n)                        return 1 if n is a perfect square
  is_power(n)                         return k if n = c^k for integer c
  is_power(n,k)                       return 1 if n = c^k for integer c, k
  is_power(n,k,\$root)                as above but also set $root to c.
  is_prime_power(n)                   return k if n = p^k for prime p
  is_prime_power(n,\$p)               as above but also set $p to p
  is_square_free(n)                   return true if no repeated factors
  is_carmichael(n)                    is n a Carmichael number
  is_quasi_carmichael(n)              is n a quasi-Carmichael number
  is_primitive_root(r,n)              is r a primitive root mod n
  is_pillai(n)                        v where  v! % n == n-1  and  n % v != 1
  is_semiprime(n)                     does n have exactly 2 prime factors
  is_polygonal(n,k)                   is n a k-polygonal number
  is_polygonal(n,k,\$root)            as above but also set $root
  is_fundamental(d)                   is d a fundamental discriminant
  is_totient(n)                       is n = euler_phi(x) for some x
  sqrtint(n)                          integer square root
  rootint(n,k)                        integer k-th root
  rootint(n,k,\$rk)                   as above but also set $rk to r^k
  logint(n,b)                         integer logarithm
  logint(n,b,\$be)                    as above but also set $be to b^e.
  gcd(@list)                          greatest common divisor
  lcm(@list)                          least common multiple
  gcdext(x,y)                         return (u,v,d) where u*x+v*y=d
  chinese([a,mod1],[b,mod2],...)      Chinese Remainder Theorem
  primorial(n)                        product of primes below n
  pn_primorial(n)                     product of first n primes
  factorial(n)                        product of first n integers: n!
  factorialmod(n,m)                   factorial mod m
  binomial(n,k)                       binomial coefficient
  partitions(n)                       number of integer partitions
  valuation(n,k)                      number of times n is divisible by k
  hammingweight(n)                    population count (# of binary 1s)
  kronecker(a,b)                      Kronecker (Jacobi) symbol
  addmod(a,b,n)                       a + b mod n
  mulmod(a,b,n)                       a * b mod n
  divmod(a,b,n)                       a / b mod n
  powmod(a,b,n)                       a ^ b mod n
  invmod(a,n)                         inverse of a modulo n
  sqrtmod(a,n)                        modular square root
  moebius(n)                          Moebius function of n
  moebius(beg, end)                   array of Moebius in range
  mertens(n)                          sum of Moebius for 1 to n
  euler_phi(n)                        Euler totient of n
  euler_phi(beg, end)                 Euler totient for a range
  jordan_totient(n,k)                 Jordan&#39;s totient
  carmichael_lambda(n)                Carmichael&#39;s Lambda function
  ramanujan_sum(k,n)                  Ramanujan&#39;s sum
  exp_mangoldt                        exponential of Mangoldt function
  liouville(n)                        Liouville function
  znorder(a,n)                        multiplicative order of a mod n
  znprimroot(n)                       smallest primitive root
  chebyshev_theta(n)                  first Chebyshev function
  chebyshev_psi(n)                    second Chebyshev function
  hclassno(n)                         Hurwitz class number H(n) * 12
  ramanujan_tau(n)                    Ramanujan&#39;s Tau function
  consecutive_integer_lcm(n)          lcm(1 .. n)
  lucasu(P, Q, k)                     U_k for Lucas(P,Q)
  lucasv(P, Q, k)                     V_k for Lucas(P,Q)
  lucas_sequence(n, P, Q, k)          (U_k,V_k,Q_k) for Lucas(P,Q) mod n
  bernfrac(n)                         Bernoulli number as (num,den)
  bernreal(n)                         Bernoulli number as BigFloat
  harmfrac(n)                         Harmonic number as (num,den)
  harmreal(n)                         Harmonic number as BigFloat
  stirling(n,m,[type])                Stirling numbers of 1st or 2nd type
  numtoperm(n,k)                      kth lexico permutation of n elems
  permtonum([a,b,...])                permutation number of given perm
  randperm(n,[k])                     random permutation of n elems
  shuffle(...)                        random permutation of an array</code></pre>

<h2 id="NON-INTEGER-MATH">NON-INTEGER MATH</h2>

<pre><code>  ExponentialIntegral(x)              Ei(x)
  LogarithmicIntegral(x)              li(x)
  RiemannZeta(x)                      &zeta;(s)-1, real-valued Riemann Zeta
  RiemannR(x)                         Riemann&#39;s R function
  LambertW(k)                         Lambert W: solve for W in k = W exp(W)
  Pi([n])                             The constant &pi; (NV or n digits)</code></pre>

<h2 id="SUPPORT">SUPPORT</h2>

<pre><code>  prime_get_config                    gets hash ref of current settings
  prime_set_config(%hash)             sets parameters
  prime_memfree                       frees any cached memory</code></pre>

<h1 id="COPYRIGHT">COPYRIGHT</h1>

<p>Copyright 2011-2017 by Dana Jacobsen &lt;dana@acm.org&gt;</p>

<p>This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>


</body>

</html>


